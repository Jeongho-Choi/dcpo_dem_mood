---
output: 
  pdf_document:
    citation_package: natbib
    keep_tex: true
    fig_caption: true
    latex_engine: pdflatex
    template: svm-latex-ms2.tex
title: "[dcpo_demsupport]"
thanks: "The authors contributed equally to this work.  Corresponding author: [yuehong-tai@uiowa.edu](mailto:yuehong-tai@uiowa.edu).  Current version: `r format(Sys.time(), '%B %d, %Y')`."
author:
- name: Yuehong 'Cassandra' Tai
  affiliation: University of Iowa
- name: Yue Hu
  affiliation: Tsinghua University
- name: Frederick Solt
  affiliation: University of Iowa
abstract: "Public opinion’s effect on democratic institutions is important and long-studied topic.  Claassen (2020) renewed attention to this question by using a Bayesian latent variable approach to measure mass democratic support from survey data and concluded such support has a positive effect on subsequent democratic change and especially on democracy’s endurance once in place.  In this article, we reexamine the question, bringing more survey data on democratic support; a superior measure, Dynamic Comparative Public Opinion (DCPO); and an improved methodological approach that takes the uncertainty in this measure into account.  Our results [further reinforce/contradict] the long-held view that democracies depend on public support to survive."
keywords: ""
date: "`r format(Sys.time(), '%B %d, %Y')`"
fontsize: 11pt
spacing: double
bibliography: \dummy{`r file.path(getwd(), list.files(getwd(), ".bib$", recursive = TRUE))`}
# csl: https://raw.githubusercontent.com/citation-style-language/styles/master/american-political-science-association.csl
biblio-style: apsr
citecolor: black
linkcolor: black
endnote: no
header-includes:
      - \usepackage{array}
      - \usepackage{caption}
      - \usepackage{graphicx}
      - \usepackage{siunitx}
      - \usepackage{colortbl}
      - \usepackage{multirow}
      - \usepackage{hhline}
      - \usepackage{calc}
      - \usepackage{tabularx}
      - \usepackage{threeparttable}
      - \usepackage{wrapfig}
nocite: |
  @Solt2020a
---
One of the classic but disputable questions in comparative politics is the relationship between mass democratic support and countries' level of democracy.
A long-standing and widely accepted theory is that the level of mass democratic support determines the stability of a democratic system [e.g., @lipset_social_1959; @norris_democratic_2011], but findings from empirical analyses still remain inconclusive [@inglehart_modernization_2005; @fails_changing_2010; @qi_how_2011, see @Claassen2020a for a review in this literature].
One reason for the mixed results is the measurement of public democratic support.
Measuring democratic support by using self-report survey data is still the dominant approach.
However, one essential concern is whether and how we can measure the latent public opinion correctly, especially for comparative public opinion survey data.
The sparse and incomparable comparative public opinion data has perplexed the study of comparative politics for a long time [@Solt2020a].
Public support for democracy is a latent variable and the incorrect measurement of it may conceal the real relationship between public opinion and democratic institutional development.
Recently, a few pioneering studies are contributing to the latent public opinion measurement in comparative studies[@Caughey2019,@Claassen2019,@Solt2020a].     
A prominent study by @Claassen2020a applied an advanced Bayesian Item Response Model to measure dynamic public democratic support for 135 countries for up to 29 years.
It found that mass democratic support had a positive impact on democratic change, especially the endurance of democracy.
@Claassen2020a's study reignites the debate on the relationship between public opinion and democracy.
To adjudicate/contribute to the ongoing debate, by using a superior measurement, bigger data, and incorporating uncertainty, our study presents a thorough reexamination of the relationship between mass democratic support and democracy survival across counties and over time.
We use a superior measure, the Dynamic Comparative Public Opinion (DCPO) model developed by@Solt2020a, to estimate democratic support for a larger dataset with 144 countries for up to 33 years between 1988 and 2020.
In addition to accounting for item response bias across countries and the extent of polarization by generating estimates on bounded scales, the DCPO model has superiority in dealing with both binominal and ordinal survey data across countries over time.
Both internal and external k-fold validation tests corroborate that the DCPO model yields more accurate results than other latent variable measurements, either of @Claassen2019 Model 5 and @Caughey2019 model.
The nature of latent variables' unobservability decides that the estimates of latent variables are inherently accompanied with measurement uncertainty. 
Omitting measurement error distorts both statistical and substantive inference (See Juhl 2019for review in this literature). 
Since the measurement uncertainty could have consequential (propagated) effects on inferences about the relationship of substantive interests, it is strongly recommended to incorporate the measurement uncertainty in analysis models (Treier and Jackman 2008, Crabtree and Fariss 2015). 
Many scholars have taken the account for measurement error in analyses as a final crucial part in their empirical studies (Schnakenberg and Fariss 2014, Caughey and Warshaw 2018), and recent studies on latent variable measurement emphasized the incorporation of measurement uncertainty when using their measures ( Solis and Waggoner 2020, Gandhi and Sumner 2020). 
However, in the comparative public opinion field, previous efforts on measuring comparative public opinion didn’t account for measurement uncertainty in their analyses.  
To address the uncertainty (caused by the inherent trail of latent constructs), in addition to employing the DCPO which reduces uncertainty in measurement, we also incorporated uncertainty in our analysis by using random draws from the posterior distributions and following @Rubin1987's rules. 
Surprisingly, our study reveals that there is no significant relationship between public support and democratic change in both the replication analysis of @Claassen2020a model and the DCPO analysis when uncertainty is included.
Our study reaffirms Fariss 2014, Juhl (2019) and Solt (2020)'s suggestion that given the latent character of variables in political science, scholars should be vigilant in measurement uncertainty. 
In addition to methodological concerns, our reanalysis echoes recent studies about the public’s behavioral commitment to democracy.  
It is questionable whether self-report based conventional measures of support for democracy could transfer to behaviorally democratic commitments when the democratic system is in economic or societal crisis.
Recent studies show that although the public understands and supports democratic principles, their support is elastic, especially in the context of polarization [@graham_democracy_2020].
Voters sometimes are willing to subordinate democratic norms to their partisan and policy preferences [@nyhan_who_2020] and subsequently support their elected leaders to take anti-democratic measures [@mccoy_democratic_2020].


```{r setup, include=FALSE}
options(tinytex.verbose = TRUE)

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, eval = FALSE, dpi = 300)

# If you haven't install `DCPOtools`
# remotes::install_github("fsolt/DCPOtools")

if (!require(pacman)) install.packages("pacman")
library(pacman)

# load all the packages you will use below 
p_load(
  dataverse, # data scraping
  DCPOtools,
  boot, plm, # analysis
  flextable, kableExtra, modelsummary, # tabulation
  gridExtra,
  latex2exp, # visualization
  rstan, # Bayesian estimation
  broom, tidyverse, # data wrangling
  dotwhisker, # visualization
) 

# Functions preload
set.seed(313)

get_legend<-function(myggplot){
  tmp <- ggplot_gtable(ggplot_build(myggplot))
  leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
  legend <- tmp$grobs[[leg]]
  return(legend)
}

# Theme setup
theme_set(theme_minimal())
source("../R/uiowa_palette.R")
```

<!-- The following text is all cribbed from `fsolt/dcpo_article` and obviously needs heavy revision -->

# More Data
We collected data on 62 items from 17 survey projects in 159 countries covering years from 1988 to 2020.
Survey data was extracted automatically through the `DCPO` package for R [@Solt2020a], which is written in the Stan probabilistic programming language [@StanDevTeam2019a; @StanDevTeam2019b].
The DCPO package also automatically identifies the year in which the survey was conducted, which contributes to the capture of the real relationship between public opinion and the level of democracy.
Our data consists of 1,465 country-years and 1,861 national surveys, which is a 24.4% and 33.9% increase respectively over 1,178 country-years and 1,390 national surveys used in Claassen's study [-@Claassen2020a; -@Claassen2020b].


```{r dcpo_input_raw, eval = FALSE}
dcpo_input_raw <- DCPOtools::dcpo_setup(vars = read_csv("data-raw/mood_dem.csv",
                                                          col_types = "cccccc"),
                                          file = "data/dcpo_input_raw.csv")
```

```{r dcpo_input, eval = FALSE}
dcpo_input_raw1 <- read_csv("data/dcpo_input_raw.csv", col_types = "cdcddcd") %>% 
  filter(!(str_detect(survey, "army_wvs") & # WVS obs identified as problematic by Claassen 
                 ((country=="Albania" & year==1998) |
                      (country=="Indonesia" & (year==2001 | year==2006)) |
                      (country=="Iran" & year==2000) |
                      (country=="Pakistan" & (year==1997 | year==2001)) | # 1996 in Claassen
                      (country=="Vietnam" & year==2001)) |
                 (str_detect(item, "strong_wvs") &
                      ((country=="Egypt" & year==2012) |
                           (country=="Iran" & (year==2000 | year==2007)) | # 2005 in Claassen
                           (country=="India") |
                           (country=="Pakistan" & (year==1997 | year==2001)) | # 1996 in Claassen
                           (country=="Kyrgyzstan" & (year==2003 | year==2011)) |
                           (country=="Romania" & (year==1998 | year==2005 | year==2012)) |
                           (country=="Vietnam" & year==2001))) |
                 (country %in% c("Puerto Rico", "Northern Ireland", 
                                 "SrpSka Republic", "Hong Kong SAR China")))) %>%
  with_min_yrs(2)

dcpo_input <- DCPOtools::format_dcpo(dcpo_input_raw1,
                                     scale_q = "church_lb",
                                     scale_cp = 2)
save(dcpo_input, file = here::here("data", "dcpo_input.rda"))
```

```{r compare_n, eval = FALSE}
if (!file.exists("data/supdem raw survey marginals.tab")) {
  dataverse::get_file("supdem raw survey marginals.tab", "doi:10.7910/DVN/HWLW0J") %>% 
    read_csv(col_types = "cdcddcdc") %>% 
    write_csv("data/supdem raw survey marginals.tab")
}

supdem <- read_csv("data/supdem raw survey marginals.tab",
                   col_types = "cdcddcdc") %>% 
  janitor::clean_names() %>% 
  with_min_yrs(2)

supdem_ncy <- supdem %>%
  dplyr::select(country, year) %>% 
  unique() %>% 
  nrow()

supdem_ncyi <- supdem %>%
  dplyr::select(country, year, item) %>% 
  unique() %>% 
  nrow()

dcpo_input_ncy <- dcpo_input_raw1 %>% 
  dplyr::select(country, year) %>% 
  unique() %>% 
  nrow()

dcpo_input_ncyi <- dcpo_input_raw1 %>% 
  dplyr::select(country, year, item) %>% 
  unique() %>% 
  nrow()

increase_cy <- sprintf("%2.1f", (dcpo_input_ncy/supdem_ncy - 1) * 100, 1)
increase_cyi <- sprintf("%2.1f", (dcpo_input_ncyi/supdem_ncyi - 1) * 100, 1)
```

# A Better Measure of Democratic Support
Using the DCPO model in the `DCPO` package, we attained 4,752 estimates for mass support for democracy, drawn from 144 countries with at least 2 country-years observed.
The DCPO model has methodological superiority in significant ways. 
First, the DCPO model allows us to treat the data as their original scales, either dichotomous or ordinal, to avoid information missing due to the potential scale change.
For example, our data consists of 20,885 national responses as the result of measuring public attitude at ordinal scales, which has the potential to give us more nuances about public democratic support. 
Second, to reduce the uncertainty in estimating countries which lie at the extreme ends of the public opinion spectrum[@Linzer2015], the estimates of mean public opinion are bounded and the extent of polarization is included in the DCPO model.
The capture of the extent of polarization is more meaningful in this era, since the respondents from countries with more polarized opinions are more likely to give negative responses even though these countries may have the similar mean estimates of public opinion. 
It is worth noticing that the small number of extreme opinions in countries may have a louder voice and bigger effects on actual politics. 
Third, to address the differences in item response across countries, caused by factors other than public attitude or preference, a country-specific item bias is modelled as "a country-specific bias in the difficulty of each question" [@Solt2020a, 6]. 
This approach allows us to keep information embedded in questions rather than discarding them directly. 
In sum, the DCPO model has methodological advantages in keeping as much available information as possible, reducing uncertainty by bounding scales and capturing the extent of polarization. 
The validation tests in @Solt2020a's paper corroborate that DCPO not only features the smallest mean absolute error (MAE) and largest improvement over the country-means MAE but also provides a more stable and efficient prediction on out-of-sample data than either the @Claassen2019's Model 5 or the @Caughey2019's model.
Following @Solt2020a's approach, our validation test employs k-fold validation with 10 folds, which reduces the misrepresentation of the model due to the chosen data from single cross-validation (See details of the validation test in Appendix).


```{r dcpo, eval=FALSE}
iter <- 3000

dcpo_output <- dcpo(dcpo_input,
                    iter = iter,
                    chains = 4,
                    thin = iter/500, # this yields 250 draws per chain, 1000 draws total
                    pars = c("sd_delta","sd_theta_evolve", "sd_sigma_evolve", "sigma","phi","beta","alpha","delta","theta","y_r_pred","log_lik"))

save(dcpo_output, file = here::here("data", "dcpo_output.rda"))

dcpo_theta <- rstan::extract(dcpo_output, pars = "theta")

save(dcpo_theta, file = here::here("data", "dcpo_theta.rda"))

dcpo_sigma <- rstan::extract(dcpo_output, pars = "sigma")

save(dcpo_sigma, file = here::here("data", "dcpo_sigma.rda"))

dcpo_y_r_pred <- rstan::extract(dcpo_output, pars = "y_r_pred")

save(dcpo_input, dcpo_y_r_pred, file = here::here("data", "dcpo_y_r_pred.rda"))
```

# Incorporating Uncertainty
The latent constructs are inherently accompanied by amount of measurement uncertainty due to the unobservability of variables.
The measurement is more far away from perfection when concepts are complex. 
With a strong assumption that latent variables are measured perfectly, the omittance of measurement error might obscure the true relationship between theoretical concepts and invalidates findings.
Therefore, incorporating uncertainty is substantively necessary for “comparing relationship between complex theoretical concepts across political contexts and over time"[@Crabtree2015,p2]. 
In our reexamination, instead of employing the point estimates, we relax the implausible assumption of perfect measurement of latent variables. We followed the recommendation and the approach of incorporating uncertainty in using latent variables [e.g., @Schnakenberg2014; @Crabtree2015] and other measures, such as the Standardized World Income Inequality Database [@Solt2020].
Specifically, we generated 1,000 duplicate versions of the analysis dataset, assigned to each a different random draw from the posterior distributions of public democratic support, performed the analyses repeatedly on each of these 1,000 versions of the dataset, and then combined the results following the rules set out in @Rubin1987.
This process can be achieved by using the `purrr` package [@Henry2019] and adding only a few lines of code.

```{r country-years}
path_df <-
  list.files(
    "../data",
    pattern = ".*_theta.rda",
    recursive = TRUE,
    full.names = TRUE
  ) %>%
  .[str_which(., "claassen")]

load(path_df)

df_thetaDraw <- map_df(seq(claassen_m5_theta$theta[1, , 1]),
       function(year) {
         map_df(seq(claassen_m5_theta$theta[1, 1, ]),
                function(country) {
                  df_temp <-
                    sample(claassen_m5_theta$theta[, year, country],
                           size = 100,
                           replace = TRUE) %>%
                    matrix(ncol = 100) %>%
                    as_tibble()
                  df_temp$yearID <- year
                  df_temp$countryID <- country
                  return(df_temp)
                })
       }) %>% 
  pivot_longer(
    cols = starts_with("V"),
    names_to = "draw",
    values_to = "theta"
  ) %>% 
  group_split(draw)
```

# Results

<!-- I may suggest to move this paragraph to the beginning of the previous section or a separate section of research design -->

**To examine the influence of empirical uncertainty, we conducted a three-step test. 
We first reproduced @Claassen2019.
Then applying the method he described in the article, we replicated his IRT-based measurement of democratic mood and maintain the entire distribution of the predicted outcome, instead of aggregating to a single point estimate.
Utilizing the estimated distribution, we involved uncertainty to the analysis of the influence of democratic mood on institutional democracy cross-nationally.
In the third step, we applied an advanced method and added one-third more data to the analysis to reduce potential effects of measurement biases and data spareness.
We compared the outcomes of the three steps and showed as below that uncertainty is an critical factor in the studies of mass democratic attitude, which may alter the analytic conclusions. 
We further show that accounting for uncertainty is at least equivalently important when the latent-variable estimates plays as the dependent variable in a study by replicating Claassen2020b. **


```{r dataInput}

supdem <- read.csv("../data/Support_democracy_ajps.csv")
v_dem <- read.csv("../data/vdem15.csv")
sd.plm <- pdata.frame(supdem, index = c("Country", "Year")) 

load(here::here("data", "claassen_replication_input.rda"))
load(here::here("data", "claassen_m5_theta.rda"))
load(here::here("data", "dcpo_input.rda"))
load(here::here("data", "dcpo_theta.rda"))
load(here::here("data", "dcpo_sigma.rda"))
load(here::here("data", "dem_mood_apsr.RData"))


## Beck-Katz panel-corrected standard errors
vcovBK_se <- function(x) {
  plm::vcovBK(x, cluster = "time") %>% 
    diag() %>% 
    sqrt()
}


vcovHC_se <-  function(x) {
  plm::vcovHC(x, method="arellano", cluster="group") %>% 
    diag() %>% 
    sqrt()
}


reformat_dcpo_output <- function(x, parameter_name) {
  df_temp <- x %>% 
    as_tibble(.name_repair = ~ls_country) %>% 
    mutate(year = first_year + row_number() - 1) %>% 
    pivot_longer(cols = all_of(ls_country),
                 names_to = "country",
                 values_to = parameter_name) %>%
    arrange(country, year)
  return(df_temp)
}
```

```{r claassenAJPS}
# Pooled model -----
# regime = ifelse(sd2$Regime_VD > 1, 1, 0)

ls_mod <-
  paste0(
    "Libdem_VD ~ plm::lag(Libdem_VD, 1:2) + ",
    c(
      "plm::lag(SupDem_trim, 1)",
      "plm::lag(SupDem_Democ, 1) + plm::lag(SupDem_Autoc, 1)"
    ),
    "+ plm::lag(lnGDP_imp, 1) + plm::lag(GDP_imp_grth, 1) + plm::lag(Libdem_regUN, 1) + plm::lag(Pr_Muslim, 1) + plm::lag(Res_cp_WDI_di, 1)"
  )

df_result_cls <- map(ls_mod, function(mod){
  result <- plm(mod, model = "pooling", data = sd.plm)
  df_result <- tidy(result, conf.int = TRUE) %>%
    mutate(std.error = vcovBK_se(result),
           n = nobs(result))
})

save(df_result_cls, file = here::here("output", "estimates_clsMeanAJPS.RDS"))
```

```{r claassenUncertaintyAJPS}

ls_country <- unique(claassen_replication_input$data$country)
first_year <- min(claassen_replication_input$data$year)

sd_control <- sd.plm %>%
  mutate(
    country = as.character(Country),
    year = as.numeric(as.character(Year)),
    regime = ifelse(Regime_VD > 1, 1, 0)
  )

df_cls <- purrr::map(1:1000, function(anEntry) {
  claassen_m5_theta$theta[anEntry,,] %>% 
    reformat_dcpo_output("theta") %>% 
    # left_join(reformat_dcpo_output(dcpo_sigma$sigma[anEntry,,], "sigma"),
    #           by = c("year", "country")) %>%
    left_join(sd_control, by = c("country", "year")) %>% 
    mutate(theta_dem = theta * regime,
           theta_aut = theta * (1 - regime)) %>% 
    plm::pdata.frame(index = c("country", "year"))
})

estimate_cls <- function(aModel, aType = "pooling") {
  if (aType == "gmm") {
    result_cls_1k <- map(df_cls, function(aDataset) {
      pgmm(
        as.formula(aModel),
        effect = "individual",
        model = "onestep",
        transformation = "ld",
        indexes = c("Country", "Year"),
        data = aDataset
      )
    })
    
    result_vars_cls_1k <-
      mitools::MIextract(result_cls_1k, fun = vcovHC_se)
    
  } else {
    result_cls_1k <- map(df_cls, function(aDataset) {
      plm::plm(aModel,
               model = "pooling",
               data = aDataset)
    })
    
    result_vars_cls_1k <-
      mitools::MIextract(result_cls_1k, fun = vcovBK_se)
  }
  
  result_betas_cls_1k <-
    mitools::MIextract(result_cls_1k, fun = coef)
  
  df_result_cls <-
    summary(
      mitools::MIcombine(results = result_betas_cls_1k, variance = result_vars_cls_1k)
    ) %>% rownames_to_column(var = "term") %>%
    rename(conf.low = `(lower`,
           conf.high = `upper)`,
           estimate = results) %>%
    filter(!str_detect(term, "(Intercept)"))
}

mod_ls <- paste0(
  "Libdem_VD ~ plm::lag(Libdem_VD, 1:2) + ",
  c("plm::lag(theta, 1)", 
    "plm::lag(theta_dem, 1) + plm::lag(theta_aut, 1) "), 
  " + plm::lag(lnGDP_imp, 1) + plm::lag(GDP_imp_grth, 1) + plm::lag(Libdem_regUN, 1) + plm::lag(Pr_Muslim, 1) + plm::lag(Res_cp_WDI_di, 1)"
)

df_result_clsUncertain <- map(mod_ls, estimate_cls)

save(df_result_clsUncertain, file = here::here("output", "estimates_clsAJPS.RDS"))
```

```{r dcpoPointAJPS}
ls_country <- levels(dcpo_input$data$kk)
first_year <- min(dcpo_input$data$year)

df_dcpoMean <- purrr::map_df(1:1000, function(anEntry) {
  dcpo_theta$theta[anEntry,,] %>% 
    reformat_dcpo_output("theta") %>% 
    left_join(reformat_dcpo_output(dcpo_sigma$sigma[anEntry,,], "sigma"),
              by = c("year", "country"))
}) %>% 
  group_by(country, year) %>% 
  summarise(theta = mean(theta), 
            sigma = mean(sigma))

save(df_dcpoMean, file = here::here("output", "estimates_dcpoMean.RDS"))

df_controls <- read_csv(here::here("data", "control_variables_ajps.csv"),
                        col_types = cols(.default = col_double(),
                                         country = col_character(),
                                         country_name = col_character(),
                                         ISO = col_character(),
                                         Region_UN = col_character())) %>% 
  mutate(country0 = iconv(country, "latin1", "UTF-8", sub=''),
         country = countrycode::countrycode(country0, "country.name", "country.name"),
         regime = Vdem_regime > 1) %>% 
  filter(year >= firstyear) # using trimmed data as Claassen 

df_dcpoMeanAJPS <- df_dcpoMean %>% 
  right_join(df_controls, by = c("country", "year")) %>% 
  mutate(theta_dem = theta * regime,
         theta_aut = theta * (1 - regime)) %>% 
    plm::pdata.frame(index = c("country", "year"))

ls_mod <- paste0(
  "Vdem_libdem ~ plm::lag(Vdem_libdem, 1:2) + ", 
  c("plm::lag(theta, 1)", 
    "plm::lag(theta_dem, 1) + plm::lag(theta_aut, 1) "), 
  " + plm::lag(lg_imp_mdpgdp, 1) +
             plm::lag(mdprgdp_grwth, 1) + plm::lag(Region_libdem, 1) +
             plm::lag(muslism_prop_2010, 1) + plm::lag(dependence_pc_di, 1)"
)


df_result_dcpoMeanAJPS <- map(ls_mod, function(mod){
  result <- plm(mod, model = "pooling", data = df_dcpoMeanAJPS)
  df_result <- tidy(result) %>%
    mutate(std.error = vcovBK_se(result),
           n = nobs(result))
})

save(df_result_dcpoMeanAJPS, file = here::here("output", "estimates_dcpoMeanAJPS.RDS"))
```

```{r dcpoUncertaintyAJPS}
df_dcpo <- purrr::map(1:1000, function(anEntry) {
  dcpo_theta$theta[anEntry,,] %>% 
    reformat_dcpo_output("theta") %>% 
    left_join(reformat_dcpo_output(dcpo_sigma$sigma[anEntry,,], "sigma"),
              by = c("year", "country")) %>%
    left_join(df_controls, by = c("country", "year")) %>% 
    mutate(theta_dem = theta * regime,
           theta_aut = theta * (1 - regime)) %>% 
    plm::pdata.frame(index = c("country", "year"))
})

estimate_dcpo <- function(aModel, aType = "pooling") {
  if (aType == "gmm") {
    result_dcpo_1k <- map(df_dcpo, function(aDataset) {
      pgmm(
        as.formula(aModel),
        effect = "individual",
        model = "onestep",
        transformation = "ld",
        indexes = c("Country", "Year"),
        data = aDataset
      )
    })
    
    result_vars_dcpo_1k <-
      mitools::MIextract(result_dcpo_1k, fun = vcovHC_se)
    
  } else {
    result_dcpo_1k <- map(df_dcpo, function(aDataset) {
      plm::plm(aModel,
               model = "pooling",
               data = aDataset)
    })
    
    result_vars_dcpo_1k <-
      mitools::MIextract(result_dcpo_1k, fun = vcovBK_se)
  }
  
  result_betas_dcpo_1k <-
    mitools::MIextract(result_dcpo_1k, fun = coef)
  
  df_result_dcpo <-
    summary(
      mitools::MIcombine(results = result_betas_dcpo_1k, variance = result_vars_dcpo_1k)
    ) %>% rownames_to_column(var = "term") %>%
    rename(conf.low = `(lower`,
           conf.high = `upper)`,
           estimate = results) %>%
    filter(!str_detect(term, "(Intercept)"))
}

mod_ls <- paste0(
  "Vdem_libdem ~ plm::lag(Vdem_libdem, 1:2) + ", 
  c("plm::lag(theta, 1)", 
    "plm::lag(theta_dem, 1) + plm::lag(theta_aut, 1) "), 
  " + plm::lag(lg_imp_mdpgdp, 1) +
             plm::lag(mdprgdp_grwth, 1) + plm::lag(Region_libdem, 1) +
             plm::lag(muslism_prop_2010, 1) + plm::lag(dependence_pc_di, 1)"
)

df_result_dcpoAJPS <- map(mod_ls, estimate_dcpo)

save(df_result_dcpoAJPS, file = here::here("output", "estimates_dcpoAJPS.RDS"))
```

```{r visualizeAJPS, fig.cap= "The Effect of Democratic Mood on Institutional Democratization", eval = TRUE}

load(here::here("output", "estimates_clsMeanAJPS.RDS"))
load(here::here("output", "estimates_clsAJPS.RDS"))
load(here::here("output", "estimates_dcpoAJPS.RDS"))

df_plot <- df_result_cls[[1]] %>% 
  mutate(model = "Claassen 2019") 

df_plot <- df_result_clsUncertain[[1]] %>% 
  mutate(model = "Claassen w. Uncertainty") %>%  
  bind_rows(df_plot)

df_plot <- df_result_dcpoAJPS[[1]] %>% 
  mutate(model = "DCPO") %>%  
  bind_rows(df_plot)

df_plotS <- df_plot %>%
  filter(term != "(Intercept)") %>%
  mutate(
    term = rep(
      c("Democracy\n (t-1)",
        "Democracy\n (t-2)",
      "Democratic\n Mood\n (t-1)",
      "Log GDP\n per capita\n (t−1)",
      "GDP per\n capita Growth\n (t−1)",
      "Regional\n Democracy\n (t−1)",
      "Percent\n Muslim\n (t-1)",
      "Resource\n Dependence\n (t−1)"),
    time = 3)
  )

df_tableAJPS <- df_plotS %>% mutate(
  std.error = ifelse(is.na(std.error), se, std.error)
) %>% 
  select(term, estimate, std.error, model)

plot_AJPS1 <- dwplot(df_plotS, dodge_size = 0.8, by_2sd = FALSE) +
  scale_color_uiowa(name = "", palette = "digitMixed") +
  labs(
    title = "DV: Institutional Democratization",
    subtitle = "Pooled"
  ) +
  theme(legend.position = "none")

# the attemp to change the order of legends failed. Both factorize the model ahead or using the  guides(fill = guide_legend(reverse=TRUE)) fails

df_plot <- df_result_cls[[2]] %>% 
  mutate(model = "Claassen 2019") 

df_plot <- df_result_clsUncertain[[2]] %>% 
  mutate(model = "Claassen w. Uncertainty") %>%  
  bind_rows(df_plot)

df_plot <- df_result_dcpoAJPS[[2]] %>% 
  mutate(model = "DCPO") %>%  
  bind_rows(df_plot)

df_plotS <- df_plot %>%
  filter(term != "(Intercept)") %>%
  mutate(
    term = rep(
      c("Democracy\n (t-1)",
        "Democracy\n (t-2)",
      "Democratic\n Demo Only\n (t-1)",
      "Democratic\n Auto Only\n (t-1)",
      "Log GDP\n per capita\n (t−1)",
      "GDP per\n capita Growth\n (t−1)",
      "Regional\n Democracy\n (t−1)",
      "Percent\n Muslim\n (t-1)",
      "Resource\n Dependence\n (t−1)"),
    time = 3)
  )

plot_AJPS2 <- dwplot(df_plotS, dodge_size = 0.8, by_2sd = FALSE) +
  scale_color_uiowa(name = "", palette = "digitMixed") +
  labs(
    title = "",
    subtitle = "Regime Specific"
  ) +
  theme(legend.position = "bottom")

legend <- get_legend(plot_AJPS2)

plot_AJPS2 <- plot_AJPS2 + theme(legend.position = "none")

grid.arrange(plot_AJPS1, plot_AJPS2, legend, ncol=2, nrow = 2, 
             layout_matrix = rbind(c(1,2), c(3,3)),
             widths = c(2.7, 2.7), heights = c(2.5, 0.2))

```

```{r visualizedUncertainAJPS, fig.cap= "The Effect of Democratic Mood on Institutional Democratization Accounting for Uncertainty"}

df_plot <- df_result_dcpoMeanAJPS[[1]] %>% 
  mutate(model = "DCPO\n (Point Estimates)") 
 
df_plot <- df_result_dcpoAJPS[[1]] %>%
  mutate(model = "DCPO\n (w. Uncertainty)") %>%
  rename(std.error = se) %>%
  bind_rows(df_plot)
 
plot_pooled <- filter(df_plot, model != "Claassen 2019") %>% 
  dwplot(by_2sd = FALSE) %>%
  relabel_predictors(
    c(
      `plm::lag(Vdem_libdem, 1:2)1` = "Democracy(t-1)",
      `plm::lag(Libdem_VD, 1:2)1` = "Democracy(t-1)",
      `plm::lag(Vdem_libdem, 1:2)2` = "Democracy(t-2)",
      `plm::lag(Libdem_VD, 1:2)2` = "Democracy(t-2)",
      `plm::lag(theta, 1)` = "Democratic Mood(t-1)",
      `plm::lag(SupDem_trim, 1)` = "Democratic Mood(t-1)",
      `plm::lag(lg_imp_mdpgdp, 1)` = "Log GDP per capita(t−1)",
      `plm::lag(lnGDP_imp, 1)` = "Log GDP per capita(t−1)",
      `plm::lag(mdprgdp_grwth, 1)` = "GDP per capita Growth(t−1)",
      `plm::lag(GDP_imp_grth, 1)` = "GDP per capita Growth(t−1)",
      `plm::lag(Region_libdem, 1)` = "Regional democracy(t−1)",
      `plm::lag(Libdem_regUN, 1)` = "Regional democracy(t−1)",
      `plm::lag(muslism_prop_2010, 1)` = "Percent Muslim (t-1)",
      `plm::lag(Pr_Muslim, 1)` = "Percent Muslim (t-1)",
      `plm::lag(dependence_pc_di, 1)` = "Resource Dependence(t−1)",
      `plm::lag(Res_cp_WDI_di, 1)` = "Resource Dependence(t−1)"
    )
  ) +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 2) +
  theme_minimal() +
  ggtitle("DV: Liberal Democracy (Vdem)") +
  xlab("Coefficient Estimate") +
  theme(
    axis.title.y = element_blank(),
    legend.position = "bottom",
    legend.title = element_blank()
  )

df_plot <- df_result_dcpoMeanAJPS[[2]] %>% 
  mutate(model = "DCPO\n (Point Estimates)")

df_plot <- df_result_dcpoAJPS[[2]] %>%
  mutate(model = "DCPO\n (w. Uncertainty)") %>%
  rename(std.error = se) %>%
  bind_rows(df_plot)
 
plot_pooled2 <- filter(df_plot, model != "Claassen 2019") %>% 
  dwplot(by_2sd = FALSE) %>%
  relabel_predictors(
    c(
      `plm::lag(Vdem_libdem, 1:2)1` = "Democracy(t-1)",
      `plm::lag(Vdem_libdem, 1:2)2` = "Democracy(t-2)",
      `plm::lag(theta_dem, 1)` = "Mood Democracy(t-1)",
      `plm::lag(theta_aut, 1)` = "Mood Autocracy(t-1)",
      `plm::lag(lg_imp_mdpgdp, 1)` = "Log GDP per capita(t−1)",
      `plm::lag(mdprgdp_grwth, 1)` = "GDP per capita Growth(t−1)",
      `plm::lag(Region_libdem, 1)` = "Regional democracy(t−1)",
      `plm::lag(muslism_prop_2010, 1)` = "Percent Muslim (t-1)",
      `plm::lag(dependence_pc_di, 1)` = "Resource Dependence(t−1)"
    )
  ) +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 2) +
  theme_minimal() +
  ggtitle("DV: Liberal Democracy (Vdem)") +
  xlab("Coefficient Estimate") +
  theme(
    axis.title.y = element_blank(),
    legend.position = "bottom",
    legend.title = element_blank()
  )

gridExtra::grid.arrange(plot_pooled,plot_pooled2, ncol = 2)
```

The results are presented in Figure \@ref(fig:visualizeAJPS) (and numerically in Appendix \@ref(replicateAJPS)).
In the pooled model (left panel), the aggregated measurement of democratic mood shows a positive effect on the institutional democratization in Claassen's original model, and the effect is statistically significant at the 0.05 level.
However, when accounting for the uncertainty of the latent variable measurement of the mood, the significance disappears.
We added one-third more data and applied a more efficient measurement (DCPO), resulting a saliently shrink of the range of measurement uncertainty, but the confidence intervals still cut zero---that is, remaining statistically insignificant.^[The point estimates also alters. We attribute it to additional more information and better measuring method by DCPO.]
Similar phenomenon also happens on the estimates of, for example, the second-time-unit lag of democratization and resouce dependency.

We further examined Claassen's regime specific model [@Claassen2019: Model 2].
The originally significant contribution of democratic mood in democratic regimes disappears as well, regardless whether more information and better method are applied.

```{r claassenAPSR}
sd.plm <- pdata.frame(x, index = c("Country", "Year")) 

mods <- vector(mode = "list")

mods[[1]] <- plm(
  diff(SupDem_trim, lag = 1) ~ plm::lag(SupDem_trim, 1:2) + diff(Libdem_z, lag = 1)
  + plm::lag(Libdem_z, 1) + diff(lnGDP_imp, lag = 1) + plm::lag(lnGDP_imp, 1),
  sd.plm,
  model = "pooling"
)
mods[[2]] <- plm(
  diff(SupDem_trim, lag = 1) ~ plm::lag(SupDem_trim, 1:2) + diff(Libdem_z, lag = 1)
  + plm::lag(Libdem_z, 1) + diff(lnGDP_imp, lag = 1) + plm::lag(lnGDP_imp, 1)
  + diff(Corrup_TI_z, lag = 1) + plm::lag(Corrup_TI_z, 1),
  sd.plm,
  model = "pooling"
)

df_result_clsAPSR <- map(mods, function(aMod){
  tidy(aMod, conf.int = TRUE) %>%
    mutate(std.error = vcovHC_se(aMod),
           n = nobs(aMod))
})

save(df_result_clsAPSR, file = here::here("output", "estimates_clsMeanAPSR.RDS"))
```

```{r claassenAPSRUncertainty}
ls_country <- unique(claassen_replication_input$data$country)
first_year <- min(claassen_replication_input$data$year)

sd_control <- sd.plm %>%
  mutate(
    country = as.character(Country),
    year = as.numeric(as.character(Year))
  )

df_clsAPSR <- purrr::map(1:1000, function(anEntry) {
  claassen_m5_theta$theta[anEntry,,] %>% 
    reformat_dcpo_output("theta") %>% 
    # left_join(reformat_dcpo_output(dcpo_sigma$sigma[anEntry,,], "sigma"),
    #           by = c("year", "country")) %>%
    left_join(sd_control, by = c("country", "year")) %>% 
    plm::pdata.frame(index = c("country", "year"))
})


estimate_cls <- vector(mode = "list")

estimate_cls[[1]] <- function(aDataset) {
  plm(
      diff(theta, lag = 1) ~ plm::lag(theta, 1:2) + diff(Libdem_z, lag = 1)
  + plm::lag(Libdem_z, 1) + diff(lnGDP_imp, lag = 1) + plm::lag(lnGDP_imp, 1),
      model = "pooling",
      data = aDataset
    )
}

estimate_cls[[2]] <- function(aDataset) {
  plm(
      diff(theta, lag = 1) ~ plm::lag(SupDem_trim, 1:2) + diff(Libdem_z, lag = 1)
  + plm::lag(Libdem_z, 1) + diff(lnGDP_imp, lag = 1) + plm::lag(lnGDP_imp, 1)
  + diff(Corrup_TI_z, lag = 1) + plm::lag(Corrup_TI_z, 1),
      model = "pooling",
      data = aDataset
    )
}


df_result_clsUncertainAPSR <- map(estimate_cls, function(aModel){
  aFit <- map(df_clsAPSR, aModel)
  
  result_vars_cls_1k <- mitools::MIextract(aFit, fun = vcovHC_se)
  result_betas_cls_1k <- mitools::MIextract(aFit, fun = coef)
  
  summary(
      mitools::MIcombine(results = result_betas_cls_1k, 
                         variance = result_vars_cls_1k)
    ) %>% rownames_to_column(var = "term") %>%
    rename(conf.low = `(lower`,
           conf.high = `upper)`,
           estimate = results) %>%
    filter(!str_detect(term, "(Intercept)"))

})

save(df_result_clsUncertainAPSR, file = here::here("output", "estimates_clsAPSR.RDS"))
```

```{r dcpoPointAPSR}
df_controls <- read_csv(here::here("data", "control_variables_apsr.csv"),
                        col_types = cols(.default = col_double(),
                                         country = col_character(),
                                         country_name = col_character(),
                                         ISO = col_character(),
                                         Region_UN = col_character())) %>% 
  mutate(country0 = iconv(country, "latin1", "UTF-8", sub=''),
         country = countrycode::countrycode(country0, "country.name", "country.name")) %>% 
  filter(year >= firstyear)

load(here::here("output", "estimates_dcpoMean.RDS"))

df_dcpoMeanAPSR <- df_dcpoMean %>% 
  left_join(df_controls, by = c("country", "year")) %>% 
  plm::pdata.frame(index = c("country", "year"))

mods <- vector(mode = "list")
mods[[1]] <-
  plm(
    diff(theta, lag = 1) ~ plm::lag(theta, 1:2) + diff(Vdem_libdem_z, lag = 1)
    + plm::lag(Vdem_libdem_z, 1) + diff(lg_imp_mdpgdp, lag = 1) + plm::lag(lg_imp_mdpgdp, 1),
    data = df_dcpoMeanAPSR,
    model = "pooling"
  )

mods[[2]] <-
  plm(
    diff(theta, lag = 1) ~ plm::lag(theta, 1:2) + diff(Vdem_libdem_z, lag = 1) + plm::lag(Vdem_libdem_z, 1) + diff(lg_imp_mdpgdp, lag = 1) + plm::lag(lg_imp_mdpgdp, 1) + diff(corruption_z, lag = 1) + plm::lag(corruption_z, 1),
    data = df_dcpoMeanAPSR,
    model = "pooling"
  )

df_result_dcpoMeanAPSR <- map(mods, function(aMod){
  aMod %>% 
    tidy %>%
    mutate(std.error = vcovHC_se(aMod),
           n = nobs(aMod`))
})

save(df_result_dcpoMeanAPSR, file = here::here("output", "estimates_dcpoMeanAPSR.RDS"))
```

```{r dcpoUncertaintyAPSR}
df_dcpo <- purrr::map(1:1000, function(anEntry) {
  dcpo_theta$theta[anEntry,,] %>% 
    reformat_dcpo_output("theta") %>% 
    left_join(reformat_dcpo_output(dcpo_sigma$sigma[anEntry,,], "sigma"),
              by = c("year", "country")) %>%
    left_join(df_controls, by = c("country", "year")) %>% 
    plm::pdata.frame(index = c("country", "year"))
})

estimate_dcpo <- vector(mode = "list")

estimate_dcpo[[1]] <- function(aDataset) {
  plm(
      diff(theta, lag = 1) ~ plm::lag(theta, 1:2) + diff(Vdem_libdem_z, lag = 1)
      + plm::lag(Vdem_libdem_z, 1) + diff(lg_imp_mdpgdp, lag = 1) + plm::lag(lg_imp_mdpgdp, 1),
      model = "pooling",
      data = aDataset
    )
}

estimate_dcpo[[2]] <- function(aDataset) {
  plm(
      diff(theta, lag = 1) ~ plm::lag(theta, 1:2) + diff(Vdem_libdem_z, lag = 1) + plm::lag(Vdem_libdem_z, 1) + diff(lg_imp_mdpgdp, lag = 1) + plm::lag(lg_imp_mdpgdp, 1) + diff(corruption_z, lag = 1) + plm::lag(corruption_z, 1),
      model = "pooling",
      data = aDataset
    )
}


df_result_dcpoAPSR <- map(estimate_dcpo, function(aModel){
  aFit <- map(df_dcpo, aModel)
  
  result_vars_dcpo_1k <- mitools::MIextract(aFit, fun = vcovHC_se)
  result_betas_dcpo_1k <- mitools::MIextract(aFit, fun = coef)
  
  summary(
      mitools::MIcombine(results = result_betas_dcpo_1k, 
                         variance = result_vars_dcpo_1k)
    ) %>% rownames_to_column(var = "term") %>%
    rename(conf.low = `(lower`,
           conf.high = `upper)`,
           estimate = results) %>%
    filter(!str_detect(term, "(Intercept)"))

})

save(df_result_dcpoAPSR, file = here::here("output", "estimates_dcpoAPSR.RDS"))
```

```{r visualizedAPSR, fig.cap= "Effects of Democracy on Change in Mood", eval = TRUE}

load(here::here("output", "estimates_clsMeanAPSR.RDS"))
load(here::here("output", "estimates_clsAPSR.RDS"))
load(here::here("output", "estimates_dcpoAPSR.RDS"))

df_plot <- df_result_clsAPSR[[1]] %>% 
  mutate(model = "Claassen 2020") 

df_plot <- df_result_clsUncertainAPSR[[1]] %>% 
  mutate(model = "Claassen w. Uncertainty") %>%  
  bind_rows(df_plot)

df_plot <- df_result_dcpoAPSR[[1]] %>% 
  mutate(model = "DCPO") %>%  
  bind_rows(df_plot)

df_plotS <- df_plot %>%
  filter(term != "(Intercept)") %>%
  mutate(
    term = rep(
      c("Democratic Mood\n (t-1)",
        "Democratic Mood\n (t-2)",
      "Liberal Democracy\n (Difference)",
      "Liberal Democracy\n (t-1)",
      "Log GDP\n per capita\n (Difference)",
      "Log GDP\n (t−1)"),
    time = 3)
  )

plot_APSR1 <- dwplot(df_plotS, dodge_size = 0.8, by_2sd = FALSE) +
  scale_color_uiowa(name = "", palette = "digitMixed") +
  labs(
    title = "DV: Democratic Mood",
    subtitle = "Basic"
  ) +
  theme(legend.position = "none")

 
df_plot <- df_result_clsAPSR[[2]] %>% 
  mutate(model = "Claassen 2020") 

df_plot <- df_result_clsUncertainAPSR[[2]] %>% 
  mutate(model = "Claassen w. Uncertainty") %>%  
  bind_rows(df_plot)

df_plot <- df_result_dcpoAPSR[[2]] %>% 
  mutate(model = "DCPO") %>%  
  bind_rows(df_plot)

df_plotS <- df_plot %>%
  filter(term != "(Intercept)") %>%
  mutate(
    term = rep(
      c("Democratic\n Mood\n (t-1)",
        "Democratic\n Mood\n (t-2)",
      "Liberal\n Democracy\n (Difference)",
      "Liberal\n Democracy\n (t-1)",
      "Log GDP\n per capita\n (Difference)",
      "Log GDP\n (t−1)",
      "Corruption\n (Difference)",
      "Corruption\n (t−1)"
      ),time = 3)
  )

plot_APSR2 <- dwplot(df_plotS, dodge_size = 0.8, by_2sd = FALSE) +
  scale_color_uiowa(name = "", palette = "digitMixed") +
  labs(
    title = "",
    subtitle = "w. Corruption"
  ) +
  theme(legend.position = "bottom")

legend <- get_legend(plot_APSR2)

plot_APSR2 <- plot_APSR2 +
  theme(legend.position = "none")

gridExtra::grid.arrange(plot_APSR1, plot_APSR2, legend, ncol=2, nrow = 2, 
             layout_matrix = rbind(c(1,2), c(3,3)),
             widths = c(2.7, 2.7), heights = c(2.5, 0.2))
```

```{r visualizedUncertaintyAPSR, fig.cap= "The Effect of Democratic Mood on Institutional Democratization based on DCPO"}

load(here::here("output", "estimates_dcpoAPSR.RDS"))

df_plot <- df_result_dcpoMeanAPSR[[1]] %>% 
  mutate(model = "DCPO\n (Point Estimates)") 
 
df_plot <- df_result_dcpoAPSR[[1]] %>%
  mutate(model = "DCPO\n (w. Uncertainty)") %>%
  rename(std.error = se) %>%
  bind_rows(df_plot)
 
plot_pooled <- filter(df_plot, model != "Claassen 2019") %>% 
  dwplot(by_2sd = FALSE) %>%
  relabel_predictors(
    c(
      `plm::lag(theta, 1:2)1` = "Democracy Mood(t-1)",
      `plm::lag(theta, 1:2)2` = "Democracy Mood(t-2)",
      `diff(Vdem_libdem_z, lag = 1)` = "Liberal Democracy (Diff)",
      `plm::lag(Vdem_libdem_z, 1)` = "Liberal Democracy (t-1)",
      `diff(lg_imp_mdpgdp, lag = 1)` = "Log GDP per capita(Diff)", 
      `plm::lag(lg_imp_mdpgdp, 1)` = "Log GDP per capita(t−1)",
      `plm::lag(mdprgdp_grwth, 1)` = "Corruption (Difference)"
    )
  ) +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 2) +
  theme_minimal() +
  ggtitle("DV: Liberal Democracy (Vdem)") +
  xlab("Coefficient Estimate") +
  theme(
    axis.title.y = element_blank(),
    legend.position = "bottom",
    legend.title = element_blank()
  )

df_plot <- df_result_dcpoMeanAPSR[[2]] %>% 
  mutate(model = "DCPO\n (Point Estimates)")

df_plot <- df_result_dcpoAPSR[[2]] %>%
  mutate(model = "DCPO\n (w. Uncertainty)") %>%
  rename(std.error = se) %>%
  bind_rows(df_plot)
 
plot_pooled2 <- filter(df_plot, model != "Claassen 2019") %>% 
  dwplot(by_2sd = FALSE) %>%
  relabel_predictors(
    c(
      `plm::lag(theta, 1:2)1` = "Democracy Mood(t-1)",
      `plm::lag(theta, 1:2)2` = "Democracy Mood(t-2)",
      `diff(Vdem_libdem_z, lag = 1)` = "Liberal Democracy (Diff)",
      `plm::lag(Vdem_libdem_z, 1)` = "Liberal Democracy (t-1)",
      `diff(lg_imp_mdpgdp, lag = 1)` = "Log GDP per capita(Diff)", 
      `plm::lag(lg_imp_mdpgdp, 1)` = "Log GDP per capita(t−1)",
      `diff(cpi_sd, lag = 1)` = "Corruption (Difference)",
      `plm::lag(cpi_sd, 1)` = "Corruption (t-1)"
    )
  ) +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 2) +
  theme_minimal() +
  ggtitle("DV: Liberal Democracy (Vdem)") +
  xlab("Coefficient Estimate") +
  theme(
    axis.title.y = element_blank(),
    legend.position = "bottom",
    legend.title = element_blank()
  )

gridExtra::grid.arrange(plot_pooled,plot_pooled2, ncol = 2)
```

The importance of accounting for the measurement uncertainty appear more evident when the relevant variable plays as the dependent variable. 
In Figure \@ref(fig:visualizedAPSR), we examine the thermostatic model of democratic mood [@Claassen2020b]. 
The estimates without taking uncertainty into account imply that democatic mood decreases along with the progress of democratization. 
Nevertheless, this effect no longer holds when the measurement uncertainty is involved. 

As previous operation, we tested if this alteration is caused by the data scarcity or estimating inefficiency. 
When more data and better method are applied, the confidence intervals do shrink yet remaining statistically insignificant. 
We observed the similar changes after adjusting the effect of domestic corruption [@Claassen2020b: 41]. 

# Discussion

In short, the main empirical findings about the estimated effect of public democratic support on democracy or vice versa are not replicable when measurement uncertainty is accounted, even using better measurement and more data.
There are potential causes for the null results.
First, the survey items we used might not capture real public democratic support, given the complexity of this concept and limited indicators compared to other concepts like gender egalitarian (Solt, 2021??).
Second, these survey items do capture public democratic support, but we still don’t have enough data to compensate the fragmentation and incomparability of the available comparative public opinion data, which is doomed to high uncertainty.
Methodologically, given the nature trail of latent variables and specific characters of comparative public opinion, performing analyses based on the strong assumption that comparative public attitudes are perfectly measured might exaggerate scholars' certainty methodologically and obscure a proper substantive evaluation of theoretical claims.
In addition to the potentially methodological cause (the measurement errors), the measurement errors, there are some potentially substantive causes for the disappearing relationship.
First, democratic backsliding might be mainly caused by elites.
Elites are thought to play a critical role in preserving democratic stability by respecting the limits on their behaviors (Weingast 1997).
After the Cold War, many democracies backslid and were imperiled worldwide because elected leaders lack commitment to democratic norms when the public even did not notice that (Bermeo 2016; Levtsky and Ziblatt 2018, Waldner and Lust 2018).
Second, there has been a gulf between public perception and elites’ perception on important democratic principles (McClosky, 1959).
A recent study showed that polarized public cannot get a consensus on democratic erosion which experts preserved (Carey et al 2018).
Given that the measures for democratic development are from experts, there could be a gap between public perception on democracy and the measures of the levels of democracy.
Third, since there is a difference between the public support for democracy in the abstract and under specific propositions (Bartels 2020), recent studies questioned whether conventional measures of public support for democracy could capture public realistic commitment to democracy. 
By using survey experiments, Graham and Svolik (2020) pointed out a " fundamental blind spot" in traditional measures of public democratic support: the questions regarding the support for an abstract democracy cannot capture public willingness and behavioral commitment to democratic principles when voters have to choose between democratic norms and their partisan identification or policy preference. 
It turned out that voters subordinated democratic norms to their partisan preference by not electorally penalizing their candidates who endorse measures that violate norms.
Furthermore, McCoy et al (2020) found that rather than only tolerate anti-democratic policies, voters support/encourage these policies when their co-partisans are in power. 
This increasing substantial literature emphasizes the eroding effect of polarization on democracy worldwide (McCoy et al 2019). 
Regarding the polarization, the sigma in our measurement model captures the polarization.
The figure xx shows the varying polarization in public support for democracy across countries. 
Given the uncertainty in measures of public support, it is unsurprising that we did not find the statistically significant effect of polarization.
However, the estimated effect of the interaction term between public support and polarization was negative, which referred to the attenuation effect of polarization on the impact of public support on democracy.
Specifically, the big polarization in the U.S. implies that political polarization exists not only in partisan politics but also in more general democracy values.
Future studies could take advantage of the DCPO’s polarization measurement in their analysis, given the necessity to analyze traditional relationships under the environment of polarization.




# Conclusion
In this reexamination, we show how the measurement uncertainty of public attitude causes inferential errors regardless of public attitude as an independent variable or dependent variable, even using more data and a sophisticated DCPO model which reduces the noises in measures for extreme countries. 
Our study has important implications in several aspects. 
In terms of data, although democracy and democratization are the primary theme in comparative politics, the indicators of public democratic attitude are limited compared to other concepts, like gender egalitarian (Solt 2020?).
More data and more indicators could serve to reduce the uncertainty in measuring public democratic attitude.
Employing a more reliable statistical measurement model could not only make public opinion across countries comparable and but also reduce the uncertainty in the measurement stage. 
Given the inherent uncertainty accompanying latent public opinion, and its propagated effects in analysis, we especially recommend that incorporating measurement uncertainty in analysis models is a safer way to infer the relationship between public opinion and other substantive interest especially for comparative politics, in which the measurement uncertainty of public opinion is further exacerbated by the sparse and incomparability of indicators.
Substantively, the association between public democratic attitude and democratic development might be not robust especially in the era of political polarization within countries. 
A strong estimated effect of public attitude might endure the propagated effect from the measurement uncertainty. 
However, if the effect itself is not robust enough, any theoretical inference could be easily wiped out due to the imperfect measurement of public opinion. 
It suggests that the relationship between public opinion and institution or policy making should be considered in the environment of polarization where people might subordinate their behaviorally commitment to democracy to their partisan loyalty or policy preference.  


\pagebreak


# (APPENDIX) Appendix {-},

## Models of Effect of Democratic Mood on Institutional Democratization {#replicateAJPS}

```{r tableAJPS}

```


## Models of Effects of Democracy on Change in Mood