---
output: 
  pdf_document:
    citation_package: natbib
    keep_tex: true
    fig_caption: true
    latex_engine: pdflatex
    template: svm-latex-ms2.tex
title: "Democracy, Public Support, and Measurement Uncertainty"
thanks: "The authors contributed equally to this work.  Corresponding author: [yuehu@mail.tsinghua.edu.cn](mailto:yuehu@mail.tsinghua.edu.cn).  Current version: `r format(Sys.time(), '%B %d, %Y')`."
author:
- name: Yuehong 'Cassandra' Tai
  affiliation: University of Iowa
- name: Yue Hu
  affiliation: Tsinghua University
- name: Frederick Solt
  affiliation: University of Iowa
abstract: "Do democratic regimes depend on public support to avoid backsliding? Does public support, in turn, respond thermostatically to changes in democracy? Two prominent recent studies (Claassen 2020a,b) have reinvigorated the classic hypothesis on the positive relationship between public support for democracy and regime survival--and challenged its reciprocal counterpart--by using a Bayesian latent variable approach to measure mass democratic support from cross-national survey data. But such approaches come with concomitant measurement uncertainty, and neither study incorporated this uncertainty into its analyses. In this letter, we correctly take this uncertainty in account and show that there is no support for the conclusion of either study. We then work to minimize the measurement uncertainty in public support by bringing additional survey data and a superior model of public opinion. Even with these improvements, however, our analyses fail to yield evidence in support of either hypothesis. [141/150 words]"
keywords: ""
date: "`r format(Sys.time(), '%B %d, %Y')`"
fontsize: 11pt
spacing: double
bibliography: \dummy{`r file.path(getwd(), list.files(getwd(), ".bib$", recursive = TRUE))`}
# csl: https://raw.githubusercontent.com/citation-style-language/styles/master/american-political-science-association.csl
biblio-style: apsr
citecolor: black
linkcolor: black
endnote: no
header-includes:
      - \usepackage{array}
      - \usepackage{caption}
      - \usepackage{graphicx}
      - \usepackage{siunitx}
      - \usepackage{colortbl}
      - \usepackage{multirow}
      - \usepackage{hhline}
      - \usepackage{calc}
      - \usepackage{tabularx}
      - \usepackage{threeparttable}
      - \usepackage{wrapfig}
---
# Introduction

It has long been argued that democratic regimes and public support for them are mutually reinforcing: that high levels of public support ensure democracies remain strong, and that experience with democratic governance generates robust public support [see, e.g., @lipset_social_1959; @Easton1965].
But the evidence for either side of this claim has been decidedly mixed.
Countries with greater democratic support have been found to become stronger and more stable democracies [e.g., @Inglehart2005, 251-254] and just the opposite [@Fails2010, 182-183].
Similarly, studies have alternately found that more experience with democracy yields more democratic support [e.g., @Fails2010, 183; @Wuttke2020a, 5-6] or instead that long-established democracies are suffering from democratic fatigue [e.g., @Denemark2016; @Foa2017].

One important reason for these mixed results is the difficulty in measuring democratic support over time and across many countries.
Public support for democracy cannot be directly observed, and its incorrect measurement will limit inferences about the relationships between public opinion and institutional development.
Further, the survey data available across countries and over time on support for democracy--or indeed most topics in public opinion---are sparse and incomparable, greatly hindering broadly comparative research.
Recently, a few pioneering studies have sought to overcome the hurdle of sparse and incomparable data by developing latent variable measurement models of public opinion [see @Caughey2019; @Claassen2019; @Solt2020a].
A pair of prominent recent works took advantage of this latent variable approach to measure democratic support for over one hundred countries for up to nearly three decades and to then assess, respectively, its consequences for and roots in democratic change [@Claassen2020a; @Claassen2020b].
These works concluded, first and supporting the classic argument, that mass support had a positive impact on democratic change, especially the endurance of democracy [@Claassen2020a, 127-130], and, second and directly contrary to it, democratic change has a thermostatic effect on public support, that is, that rather than generating their own support, deepening democracies provoke a backlash [@Claassen2020b, 46-50].

The models employed in these studies' analyses, though, do not account for uncertainty in their measurement of democratic support.
Because they are unobserved, latent variables are inherently accompanied by a quantity of measurement uncertainty.
To leave this uncertainty unacknowledged is to make the implausible assumption that the latent variables are measured perfectly, an assumption which distorts both statistical and substantive inference [@Crabtree2015; @juhl_measurement_2019].

In this letter, we reexamine the classic arguments about support for democracy and democratic change tested in these two pieces while correcting this oversight.
In addition to incorporating the measurement uncertainty, we also sought to reduce it by employing a superior model of public opinion, the Dynamic Comparative Public Opinion (DCPO) model developed by @Solt2020a, and more data to estimate democratic support for 144 countries for up to 33 years between 1988 and 2020.
Our analyses reveal that the significant relationships between public support and democratic change disappear once measurement uncertainty is taken into account, both in replications of @Claassen2020a and @Claassen2020b with the studies' original data and in our extension DCPO analyses that incorporate additional data.
That is, once measurement uncertainty is accounted for, there is no empirical support for either claim: declining democratic support does not appear important to subsequent democratic backsliding, and changes in democracy do not spur a thermostatic response in democratic support.
  

These null results might be caused by theoretical, methodological reasons, or both.
Methodologically, the existing survey questions might not be able to capture mass democratic attitude due to a shortage of indicators [Solt, 2021??] and the ineffectiveness of indicators in measuring the multi-faceted democratic support [@wuttke2020have] and behaviorally democratic commitments [@graham_democracy_2020; @Carey2020; @McCoy2020].
Substantive explanations might also account for the insignificant relationship: the elite-driven democratic backsliding [@weingast_political_1997; @levitsky_how_2018], the lack of a consensus on democratic erosion between the public and experts [@carey_searching_2019], and the difference between the public support in abstract and public commitments in context [@bartels_ethnic_2020; @graham_democracy_2020; @McCoy2020; @prothro_fundamental_1960; @van2017myth
].

Although we could not exclude or identify any of them in this study, our reexamination reaffirmed @fariss_respect_2014, @juhl_measurement_2019, and Solt's [-@Solt2020a] suggestion that given the latent character of variables in political science, scholars should be vigilant in measurement uncertainty.


```{r setup, include=FALSE}
options(tinytex.verbose = TRUE)

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, eval = FALSE, dpi = 300)

# If you haven't install `DCPOtools`
# remotes::install_github("fsolt/DCPOtools")

if (!require(pacman)) install.packages("pacman")
library(pacman)

# load all the packages you will use below 
p_load(
  dataverse, # data scraping
  DCPOtools,
  boot, plm, # analysis
  flextable, kableExtra, modelsummary, # tabulation
  gridExtra,
  latex2exp, # visualization
  rstan, # Bayesian estimation
  broom, tidyverse, janitor, # data wrangling
  dotwhisker # visualization
) 

# Functions preload
set.seed(313)

get_legend<-function(myggplot){
  tmp <- ggplot_gtable(ggplot_build(myggplot))
  leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
  legend <- tmp$grobs[[leg]]
  return(legend)
}

# Theme setup
theme_set(theme_minimal())
source(here::here("R", "uiowa_palette.R"))
```

# Model Specification 
To examine the influence of empirical uncertainty, we conducted a three-step test. 
The first step we made is to reproduce @Claassen2020a.
Then, applying the method he described in the article, we replicated his IRT-based measurement of democratic mood and maintained the entire distribution of the predicted outcome instead of aggregating it to a single point estimate.
Utilizing the estimated distribution, we involved uncertainty in the analysis of the influence of democratic mood on institutional democracy cross-nationally.
In the third step, we applied the DCPO measurement and added one-third more data to the analysis to reduce potential effects of measurement biases and data spareness.
We compared the outcomes of the three steps and showed as below that uncertainty is a critical factor in the studies of mass democratic attitude, which may alter the analytic conclusions. 
We further showed that accounting for uncertainty is equivalently important when the latent-variable estimates play as a dependent variable in a study by replicating @Claassen2020b.

## Incorporating Uncertainty
Given the measurement uncertainty derived by the inherent trail of latent constructs and its propagated effects on inferences about the relationship of substantive interests, it is strongly recommended to incorporate the measurement uncertainty in analysis models [@treier_democracy_2008; @Crabtree2015].
Many scholars have accounted for measurement error in analyses as a final crucial part in their empirical studies [@Schnakenberg2014; @caughey_policy_2018].
Moreover, recent studies on latent variable measurement highlighted the incorporation of measurement uncertainty when using their measures [@solis_measuring_2020; @gandhi_measuring_2020]. 
However, measurement uncertainty has not attracted attention in the comparative public opinion field.
Previous efforts on measuring dynamic comparative public opinion did not account for measurement uncertainty in analyses.

Instead of employing the point estimates, we followed the recommendation and the approach of incorporating uncertainty in using latent variables [e.g., @Schnakenberg2014; @Crabtree2015].
Specifically, in our replication of Claassen's [-@Claassen2020a] analysis models, we incorporated uncertainty using random draws from the posterior distributions. 
We generated 1,000 duplicate versions of the analysis dataset, assigned to each a different random draw from the posterior distributions of public democratic support, performed the analyses repeatedly on each of these 1,000 versions of the dataset, and then combined the results following the rules set out in @Rubin1987.


```{r dcpo_input_raw}
dcpo_input_raw <- DCPOtools::dcpo_setup(vars = read_csv(here::here("data-raw", "mood_dem.csv"),
                                                          col_types = "cccccc"),
                                          file = "data/dcpo_input_raw.csv")
```

```{r dcpo_input, eval=TRUE}
dcpo_input_raw1 <- read_csv(here::here("data", "dcpo_input_raw.csv"), col_types = "cdcddcd") %>% 
  filter(!(str_detect(survey, "army_wvs") & # WVS obs identified as problematic by Claassen 
                 ((country=="Albania" & year==1998) |
                      (country=="Indonesia" & (year==2001 | year==2006)) |
                      (country=="Iran" & year==2000) |
                      (country=="Pakistan" & (year==1997 | year==2001)) | # 1996 in Claassen
                      (country=="Vietnam" & year==2001)) |
                 (str_detect(item, "strong_wvs") &
                      ((country=="Egypt" & year==2012) |
                           (country=="Iran" & (year==2000 | year==2007)) | # 2005 in Claassen
                           (country=="India") |
                           (country=="Pakistan" & (year==1997 | year==2001)) | # 1996 in Claassen
                           (country=="Kyrgyzstan" & (year==2003 | year==2011)) |
                           (country=="Romania" & (year==1998 | year==2005 | year==2012)) |
                           (country=="Vietnam" & year==2001))) |
                 (country %in% c("Puerto Rico", "Northern Ireland", 
                                 "SrpSka Republic", "Hong Kong SAR China")))) %>%
  with_min_yrs(2)

dcpo_input <- DCPOtools::format_dcpo(dcpo_input_raw1,
                                     scale_q = "church_lb",
                                     scale_cp = 2)
save(dcpo_input, file = here::here("data", "dcpo_input.rda"))
```

```{r compare_n, eval=TRUE}
if (!file.exists(here::here("data", "supdem raw survey marginals.tab"))) {
  dataverse::get_file("supdem raw survey marginals.tab", "doi:10.7910/DVN/HWLW0J") %>% 
    read_csv(col_types = "cdcddcdc") %>% 
    write_csv("data/supdem raw survey marginals.tab")
}

supdem <- read_csv(here::here("data", "supdem raw survey marginals.tab"),
                   col_types = "cdcddcdc") %>% 
  janitor::clean_names() %>% 
  DCPOtools::with_min_yrs(2)

supdem_ncy <- supdem %>%
  dplyr::select(country, year) %>% 
  unique() %>% 
  nrow()

supdem_ncyi <- supdem %>%
  dplyr::select(country, year, item) %>% 
  unique() %>% 
  nrow()

dcpo_input_ncy <- dcpo_input_raw1 %>% 
  dplyr::select(country, year) %>% 
  unique() %>% 
  nrow()

dcpo_input_ncyi <- dcpo_input_raw1 %>% 
  dplyr::select(country, year, item) %>% 
  unique() %>% 
  nrow()

increase_cy <- sprintf("%2.1f", (dcpo_input_ncy/supdem_ncy - 1) * 100, 1)
increase_cyi <- sprintf("%2.1f", (dcpo_input_ncyi/supdem_ncyi - 1) * 100, 1)
```

## A Better Measure of Democratic Support and More Data
To reduce the uncertainty, we applied a more valid measurement, the DCPO model, to a bigger data set.
The validation tests in @Solt2020a's paper corroborate that the DCPO model yields more accurate results than other latent variable measurements, either of @Claassen2019 Model 5 and @Caughey2019 model.
The DCPO is superior to other measurements in several ways.
The flexibility of the DCPO model in treating the data as their original scales, either dichotomous or ordinal, decreases information missing due to the potential scale change.
For example, our data consists of 20,885 national responses as the result of measuring public attitude at ordinal scales, which can give us more nuances about public democratic support. 
Second, to reduce the uncertainty in estimating countries that lie at the extreme ends of the public opinion spectrum [@Linzer2015], the estimates of mean public opinion are bounded, and the extent of polarization is included in the DCPO model.
Third, to address the differences in item response across countries caused by factors other than public attitude or preference, a country-specific item bias is modelled as "a country-specific bias in the difficulty of each question" [@Solt2020a, 6]. 
In short, the DCPO model has methodological advantages in keeping as much available information as possible, reducing uncertainty by bounding scales, and capturing the extent of polarization in public. 

In addition to applying the advanced DCPO measurement, we also collected as much available data as possible. We collected data on 62 items from 17 survey projects in 159 countries covering years from 1988 to 2020.
Survey data was extracted automatically through the `DCPO` package for R [@Solt2020b].
The DCPO package also automatically identifies the year in which the survey was conducted, which contributes to capturing the real relationship between public opinion and the level of democracy.
Our data consists of `r dcpo_input_ncy` country-years and 1,861 national surveys, which is a `r increase_cy`% and 33.9% increase respectively over `r supdem_ncy` country-years and 1,390 national surveys used in Claassen's studies [-@Claassen2020a; -@Claassen2020b].
Finally, using the DCPO model in the `DCPO` package, we attained 4,752 estimates for mass support for democracy, drawn from 144 countries with at least 2 country-years observed.

```{r dcpo}
iter <- 3000

dcpo_output <- dcpo(dcpo_input,
                    iter = iter,
                    chains = 4,
                    thin = iter/500, # this yields 250 draws per chain, 1000 draws total
                    pars = c("sd_delta","sd_theta_evolve", "sd_sigma_evolve", "sigma","phi","beta","alpha","delta","theta","y_r_pred","log_lik"))

save(dcpo_output, file = here::here("data", "dcpo_output.rda"))

dcpo_theta <- rstan::extract(dcpo_output, pars = "theta")

save(dcpo_theta, file = here::here("data", "dcpo_theta.rda"))

dcpo_sigma <- rstan::extract(dcpo_output, pars = "sigma")

save(dcpo_sigma, file = here::here("data", "dcpo_sigma.rda"))

dcpo_y_r_pred <- rstan::extract(dcpo_output, pars = "y_r_pred")

save(dcpo_input, dcpo_y_r_pred, file = here::here("data", "dcpo_y_r_pred.rda"))
```



```{r country-years}
path_df <-
  list.files(
    "../data",
    pattern = ".*_theta.rda",
    recursive = TRUE,
    full.names = TRUE
  ) %>%
  .[str_which(., "claassen")]

load(path_df)

df_thetaDraw <- map_df(seq(claassen_m5_theta$theta[1, , 1]),
       function(year) {
         map_df(seq(claassen_m5_theta$theta[1, 1, ]),
                function(country) {
                  df_temp <-
                    sample(claassen_m5_theta$theta[, year, country],
                           size = 100,
                           replace = TRUE) %>%
                    matrix(ncol = 100) %>%
                    as_tibble()
                  df_temp$yearID <- year
                  df_temp$countryID <- country
                  return(df_temp)
                })
       }) %>% 
  pivot_longer(
    cols = starts_with("V"),
    names_to = "draw",
    values_to = "theta"
  ) %>% 
  group_split(draw)
```

# Results

The results are presented in Figure&nbsp;\ref{fig:visualizeAJPS} (and numerically in Appendix Table&nbsp;[A1](#AJPSreplication)).
In the pooled model (left panel), the aggregated measurement of democratic mood shows a positive effect on the institutional democratization in Claassen's original model, and the effect is statistically significant at the 0.05 level.


```{r dataInput}

supdem <- read.csv("../data/Support_democracy_ajps.csv")
v_dem <- read.csv("../data/vdem15.csv")
sd.plm <- pdata.frame(supdem, index = c("Country", "Year")) 

load(here::here("data", "claassen_replication_input.rda"))
load(here::here("data", "claassen_m5_theta.rda"))
load(here::here("data", "dcpo_input.rda"))
load(here::here("data", "dcpo_theta.rda"))
load(here::here("data", "dcpo_sigma.rda"))
load(here::here("data", "dem_mood_apsr.RData"))


## Beck-Katz panel-corrected standard errors
vcovBK_se <- function(x) {
  plm::vcovBK(x, cluster = "time") %>% 
    diag() %>% 
    sqrt()
}


vcovHC_se <-  function(x) {
  plm::vcovHC(x, method="arellano", cluster="group") %>% 
    diag() %>% 
    sqrt()
}


reformat_dcpo_output <- function(x, parameter_name) {
  df_temp <- x %>% 
    as_tibble(.name_repair = ~ls_country) %>% 
    mutate(year = first_year + row_number() - 1) %>% 
    pivot_longer(cols = all_of(ls_country),
                 names_to = "country",
                 values_to = parameter_name) %>%
    arrange(country, year)
  return(df_temp)
}
```


```{r claassenAJPS}
# Pooled model -----
# regime = ifelse(sd2$Regime_VD > 1, 1, 0)

ls_mod <-
  paste0(
    "Libdem_VD ~ plm::lag(Libdem_VD, 1:2) + ",
    c(
      "plm::lag(SupDem_trim, 1)",
      "plm::lag(SupDem_Democ, 1) + plm::lag(SupDem_Autoc, 1)"
    ),
    "+ plm::lag(lnGDP_imp, 1) + plm::lag(GDP_imp_grth, 1) + plm::lag(Libdem_regUN, 1) + plm::lag(Pr_Muslim, 1) + plm::lag(Res_cp_WDI_di, 1)"
  )

df_result_cls <- map(ls_mod, function(mod){
  result <- plm(mod, model = "pooling", data = sd.plm)
  df_result <- tidy(result, conf.int = TRUE) %>%
    mutate(std.error = vcovBK_se(result),
           n = nobs(result))
})

save(df_result_cls, file = here::here("output", "estimates_clsMeanAJPS.RDS"))
```


```{r claassenUncertaintyAJPS}

ls_country <- unique(claassen_replication_input$data$country)
first_year <- min(claassen_replication_input$data$year)

sd_control <- sd.plm %>%
  mutate(
    country = as.character(Country),
    year = as.numeric(as.character(Year)),
    regime = ifelse(Regime_VD > 1, 1, 0)
  )

df_cls <- purrr::map(1:1000, function(anEntry) {
  claassen_m5_theta$theta[anEntry,,] %>% 
    reformat_dcpo_output("theta") %>% 
    # left_join(reformat_dcpo_output(dcpo_sigma$sigma[anEntry,,], "sigma"),
    #           by = c("year", "country")) %>%
    left_join(sd_control, by = c("country", "year")) %>% 
    mutate(theta_dem = theta * regime,
           theta_aut = theta * (1 - regime)) %>% 
    plm::pdata.frame(index = c("country", "year"))
})

estimate_cls <- function(aModel, aType = "pooling") {
  if (aType == "gmm") {
    result_cls_1k <- map(df_cls, function(aDataset) {
      pgmm(
        as.formula(aModel),
        effect = "individual",
        model = "onestep",
        transformation = "ld",
        indexes = c("Country", "Year"),
        data = aDataset
      )
    })
    
    result_vars_cls_1k <-
      mitools::MIextract(result_cls_1k, fun = vcovHC_se)
    
  } else {
    result_cls_1k <- map(df_cls, function(aDataset) {
      plm::plm(aModel,
               model = "pooling",
               data = aDataset)
    })
    
    result_vars_cls_1k <-
      mitools::MIextract(result_cls_1k, fun = vcovBK_se)
  }
  
  result_betas_cls_1k <-
    mitools::MIextract(result_cls_1k, fun = coef)
  
  df_result_cls <-
    summary(
      mitools::MIcombine(results = result_betas_cls_1k, variance = result_vars_cls_1k)
    ) %>% rownames_to_column(var = "term") %>%
    rename(conf.low = `(lower`,
           conf.high = `upper)`,
           estimate = results) %>%
    filter(!str_detect(term, "(Intercept)"))
}

mod_ls <- paste0(
  "Libdem_VD ~ plm::lag(Libdem_VD, 1:2) + ",
  c("plm::lag(theta, 1)", 
    "plm::lag(theta_dem, 1) + plm::lag(theta_aut, 1) "), 
  " + plm::lag(lnGDP_imp, 1) + plm::lag(GDP_imp_grth, 1) + plm::lag(Libdem_regUN, 1) + plm::lag(Pr_Muslim, 1) + plm::lag(Res_cp_WDI_di, 1)"
)

df_result_clsUncertain <- map(mod_ls, estimate_cls)

save(df_result_clsUncertain, file = here::here("output", "estimates_clsAJPS.RDS"))
```


```{r dcpoPointAJPS}
ls_country <- levels(dcpo_input$data$kk)
first_year <- min(dcpo_input$data$year)

df_dcpoMean <- purrr::map_df(1:1000, function(anEntry) {
  dcpo_theta$theta[anEntry,,] %>% 
    reformat_dcpo_output("theta") %>% 
    left_join(reformat_dcpo_output(dcpo_sigma$sigma[anEntry,,], "sigma"),
              by = c("year", "country"))
}) %>% 
  group_by(country, year) %>% 
  summarise(theta = mean(theta), 
            sigma = mean(sigma))

save(df_dcpoMean, file = here::here("output", "estimates_dcpoMean.RDS"))

df_controls <- read_csv(here::here("data", "control_variables_ajps.csv"),
                        col_types = cols(.default = col_double(),
                                         country = col_character(),
                                         country_name = col_character(),
                                         ISO = col_character(),
                                         Region_UN = col_character())) %>% 
  mutate(country0 = iconv(country, "latin1", "UTF-8", sub=''),
         country = countrycode::countrycode(country0, "country.name", "country.name"),
         regime = Vdem_regime > 1) %>% 
  filter(year >= firstyear) # using trimmed data as Claassen 

df_dcpoMeanAJPS <- df_dcpoMean %>% 
  right_join(df_controls, by = c("country", "year")) %>% 
  mutate(theta_dem = theta * regime,
         theta_aut = theta * (1 - regime)) %>% 
    plm::pdata.frame(index = c("country", "year"))

ls_mod <- paste0(
  "Vdem_libdem ~ plm::lag(Vdem_libdem, 1:2) + ", 
  c("plm::lag(theta, 1)", 
    "plm::lag(theta_dem, 1) + plm::lag(theta_aut, 1) "), 
  " + plm::lag(lg_imp_mdpgdp, 1) +
             plm::lag(mdprgdp_grwth, 1) + plm::lag(Region_libdem, 1) +
             plm::lag(muslism_prop_2010, 1) + plm::lag(dependence_pc_di, 1)"
)


df_result_dcpoMeanAJPS <- map(ls_mod, function(mod){
  result <- plm(mod, model = "pooling", data = df_dcpoMeanAJPS)
  df_result <- tidy(result) %>%
    mutate(std.error = vcovBK_se(result),
           n = nobs(result))
})

save(df_result_dcpoMeanAJPS, file = here::here("output", "estimates_dcpoMeanAJPS.RDS"))
```


```{r dcpoUncertaintyAJPS}
df_dcpo <- purrr::map(1:1000, function(anEntry) {
  dcpo_theta$theta[anEntry,,] %>% 
    reformat_dcpo_output("theta") %>% 
    left_join(reformat_dcpo_output(dcpo_sigma$sigma[anEntry,,], "sigma"),
              by = c("year", "country")) %>%
    left_join(df_controls, by = c("country", "year")) %>% 
    mutate(theta_dem = theta * regime,
           theta_aut = theta * (1 - regime)) %>% 
    plm::pdata.frame(index = c("country", "year"))
})

estimate_dcpo <- function(aModel, aType = "pooling") {
  if (aType == "gmm") {
    result_dcpo_1k <- map(df_dcpo, function(aDataset) {
      pgmm(
        as.formula(aModel),
        effect = "individual",
        model = "onestep",
        transformation = "ld",
        indexes = c("Country", "Year"),
        data = aDataset
      )
    })
    
    result_vars_dcpo_1k <-
      mitools::MIextract(result_dcpo_1k, fun = vcovHC_se)
    
  } else {
    result_dcpo_1k <- map(df_dcpo, function(aDataset) {
      plm::plm(aModel,
               model = "pooling",
               data = aDataset)
    })
    
    result_vars_dcpo_1k <-
      mitools::MIextract(result_dcpo_1k, fun = vcovBK_se)
  }
  
  result_betas_dcpo_1k <-
    mitools::MIextract(result_dcpo_1k, fun = coef)
  
  df_result_dcpo <-
    summary(
      mitools::MIcombine(results = result_betas_dcpo_1k, variance = result_vars_dcpo_1k)
    ) %>% rownames_to_column(var = "term") %>%
    rename(conf.low = `(lower`,
           conf.high = `upper)`,
           estimate = results) %>%
    filter(!str_detect(term, "(Intercept)"))
}

mod_ls <- paste0(
  "Vdem_libdem ~ plm::lag(Vdem_libdem, 1:2) + ", 
  c("plm::lag(theta, 1)", 
    "plm::lag(theta_dem, 1) + plm::lag(theta_aut, 1) "), 
  " + plm::lag(lg_imp_mdpgdp, 1) +
             plm::lag(mdprgdp_grwth, 1) + plm::lag(Region_libdem, 1) +
             plm::lag(muslism_prop_2010, 1) + plm::lag(dependence_pc_di, 1)"
)

df_result_dcpoAJPS <- map(mod_ls, estimate_dcpo)

save(df_result_dcpoAJPS, file = here::here("output", "estimates_dcpoAJPS.RDS"))
```


```{r visualizeAJPS, fig.cap= "\\label{fig:visualizeAJPS}The Effect of Democratic Support on Democratic Institutions", eval = TRUE, fig.width=7.5, fig.height=5}

load(here::here("output", "estimates_clsMeanAJPS.RDS"))
load(here::here("output", "estimates_clsAJPS.RDS"))
load(here::here("output", "estimates_dcpoAJPS.RDS"))

df_plot <- df_result_cls[[1]] %>% 
  mutate(model = "Claassen 2020a") 

df_plot <- df_result_clsUncertain[[1]] %>% 
  mutate(model = "Claassen w/ Uncertainty") %>%  
  bind_rows(df_plot)

df_plot <- df_result_dcpoAJPS[[1]] %>% 
  mutate(model = "DCPO") %>%  
  bind_rows(df_plot)

df_plotS <- df_plot %>%
  filter(term != "(Intercept)") %>%
  mutate(
    term = rep(
      c("Democracy\n (t-1)",
        "Democracy\n (t-2)",
      "Support\n (t-1)",
      "Log GDP\n per capita\n (t-1)",
      "GDP per\n capita growth\n (t-1)",
      "Regional\n democracy\n (t-1)",
      "Percent\n Muslim\n (t-1)",
      "Resource\n dependence\n (t-1)"),
    time = 3))

terms <- factor(rev(c("Democracy[t-1]",
        "Democracy[t-2]",
      "Support[t-1]",
      "Log~GDP~per~capita[t-1]",
      "GDP~per~capita~growth[t-1]",
      "Regional~democracy[t-1]",
      "Percent~Muslim[t-1]",
      "Resource~dependence[t-1]")), levels =
      rev(c("Democracy[t-1]",
        "Democracy[t-2]",
      "Support[t-1]",
      "Log~GDP~per~capita[t-1]",
      "GDP~per~capita~growth[t-1]",
      "Regional~democracy[t-1]",
      "Percent~Muslim[t-1]",
      "Resource~dependence[t-1]")))

df_tableAJPS <- df_plotS %>% mutate(
  conf = paste0("[", round(conf.low, digits = 2), ", ", round(conf.high, digits = 2), "]"),
  group = "Pooled"
) %>% 
  select(term, estimate, conf, n, model, group) %>% 
  fill(n, .direction = "up")

plot_AJPS1 <- dwplot(df_plotS, dodge_size = 0.8, by_2sd = FALSE) +
  scale_y_discrete(labels = parse(text = levels(terms))) +
  # scale_color_uiowa(name = "", palette = "digitMixed") +
  scale_color_grey(start = 0.4, end = 0.8) +
  labs(
    title = "DV: Institutional Democratization",
    subtitle = "Pooled"
  ) +
  theme(legend.position = "none")

# the attemp to change the order of legends failed. Both factorize the model ahead or using the  guides(fill = guide_legend(reverse=TRUE)) fails
# The trick is  to use guide = guide_legend(reverse = TRUE) within scale_color_*(); see below in plotAJPS2. --FS

df_plot <- df_result_cls[[2]] %>% 
  mutate(model = "Claassen 2020a") 

df_plot <- df_result_clsUncertain[[2]] %>% 
  mutate(model = "Claassen w/ Uncertainty") %>%  
  bind_rows(df_plot)

df_plot <- df_result_dcpoAJPS[[2]] %>% 
  mutate(model = "DCPO") %>%  
  bind_rows(df_plot)

df_plotS <- df_plot %>%
  filter(term != "(Intercept)") %>%
  mutate(
    term = rep(
      c("Democracy\n (t-1)",
        "Democracy\n (t-2)",
      "Support\n demo only\n (t-1)",
      "Support\n auto only\n (t-1)",
      "Log GDP\n per capita\n (t-1)",
      "GDP per\n capita growth\n (t-1)",
      "Regional\n democracy\n (t-1)",
      "Percent\n Muslim\n (t-1)",
      "Resource\n dependence\n (t-1)"),
    time = 3)
  )

terms2 <- factor(rev(c("Democracy[t-1]",
                       "Democracy[t-2]",
                       "Support[t-1] (democracies~only)",
                       "Support[t-1] (autocracies~only)",
                       "Log~GDP~per~capita[t-1]",
                       "GDP~per~capita~growth[t-1]",
                       "Regional~democracy[t-1]",
                       "Percent~Muslim[t-1]",
                       "Resource~dependence[t-1]")), levels =
                   rev(c("Democracy[t-1]",
                         "Democracy[t-2]",
                         "Support[t-1] (democracies~only)",
                         "Support[t-1] (autocracies~only)",
                         "Log~GDP~per~capita[t-1]",
                         "GDP~per~capita~growth[t-1]",
                         "Regional~democracy[t-1]",
                         "Percent~Muslim[t-1]",
                         "Resource~dependence[t-1]")))

df_tableAJPS <- df_plotS %>% mutate(
  conf = paste0("[", round(conf.low, digits = 2), ", ", round(conf.high, digits = 2), "]"),
  group = "Regime Spec."
) %>% 
  select(term, estimate, conf, n, model, group) %>% 
  fill(n, .direction = "up") %>% 
  bind_rows(df_tableAJPS) %>% 
  mutate(estimate = round(estimate, digits = 3))

plot_AJPS2 <- dwplot(df_plotS, dodge_size = 0.8, by_2sd = FALSE) +
    scale_y_discrete(labels = parse(text = levels(terms2))) +
  # scale_color_uiowa(name = "", palette = "digitMixed") +
  scale_color_grey(start = 0.4, end = 0.8, guide = guide_legend(reverse = TRUE)) +
  labs(
    title = "",
    subtitle = "Regime Specific"
  ) +
  theme(legend.position = "bottom", 
        legend.title = element_blank())

legend <- get_legend(plot_AJPS2)

plot_AJPS2 <- plot_AJPS2 + theme(legend.position = "none")

grid.arrange(plot_AJPS1, plot_AJPS2, legend, ncol=2, nrow = 2, 
             layout_matrix = rbind(c(1,2), c(3,3)),
             widths = c(2.7, 2.7), heights = c(2.5, 0.2))

```


```{r visualizedUncertainAJPS, fig.cap= "The Effect of Democratic Mood on Institutional Democratization Accounting for Uncertainty"}

df_plot <- df_result_dcpoMeanAJPS[[1]] %>% 
  mutate(model = "DCPO\n (Point Estimates)") 
 
df_plot <- df_result_dcpoAJPS[[1]] %>%
  mutate(model = "DCPO\n (w. Uncertainty)") %>%
  rename(std.error = se) %>%
  bind_rows(df_plot)
 
plot_pooled <- filter(df_plot, model != "Claassen 2019") %>% 
  dwplot(by_2sd = FALSE) %>%
  relabel_predictors(
    c(
      `plm::lag(Vdem_libdem, 1:2)1` = "Democracy(t-1)",
      `plm::lag(Libdem_VD, 1:2)1` = "Democracy(t-1)",
      `plm::lag(Vdem_libdem, 1:2)2` = "Democracy(t-2)",
      `plm::lag(Libdem_VD, 1:2)2` = "Democracy(t-2)",
      `plm::lag(theta, 1)` = "Democratic Mood(t-1)",
      `plm::lag(SupDem_trim, 1)` = "Democratic Mood(t-1)",
      `plm::lag(lg_imp_mdpgdp, 1)` = "Log GDP per capita(t-1)",
      `plm::lag(lnGDP_imp, 1)` = "Log GDP per capita(t-1)",
      `plm::lag(mdprgdp_grwth, 1)` = "GDP per capita Growth(t-1)",
      `plm::lag(GDP_imp_grth, 1)` = "GDP per capita Growth(t-1)",
      `plm::lag(Region_libdem, 1)` = "Regional democracy(t-1)",
      `plm::lag(Libdem_regUN, 1)` = "Regional democracy(t-1)",
      `plm::lag(muslism_prop_2010, 1)` = "Percent Muslim (t-1)",
      `plm::lag(Pr_Muslim, 1)` = "Percent Muslim (t-1)",
      `plm::lag(dependence_pc_di, 1)` = "Resource Dependence(t-1)",
      `plm::lag(Res_cp_WDI_di, 1)` = "Resource Dependence(t-1)"
    )
  ) +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 2) +
  theme_minimal() +
  ggtitle("DV: Liberal Democracy (Vdem)") +
  xlab("Coefficient Estimate") +
  theme(
    axis.title.y = element_blank(),
    legend.position = "bottom",
    legend.title = element_blank()
  )

df_plot <- df_result_dcpoMeanAJPS[[2]] %>% 
  mutate(model = "DCPO\n (Point Estimates)")

df_plot <- df_result_dcpoAJPS[[2]] %>%
  mutate(model = "DCPO\n (w. Uncertainty)") %>%
  rename(std.error = se) %>%
  bind_rows(df_plot)
 
plot_pooled2 <- filter(df_plot, model != "Claassen 2019") %>% 
  dwplot(by_2sd = FALSE) %>%
  relabel_predictors(
    c(
      `plm::lag(Vdem_libdem, 1:2)1` = "Democracy(t-1)",
      `plm::lag(Vdem_libdem, 1:2)2` = "Democracy(t-2)",
      `plm::lag(theta_dem, 1)` = "Mood Democracy(t-1)",
      `plm::lag(theta_aut, 1)` = "Mood Autocracy(t-1)",
      `plm::lag(lg_imp_mdpgdp, 1)` = "Log GDP per capita(t-1)",
      `plm::lag(mdprgdp_grwth, 1)` = "GDP per capita Growth(t-1)",
      `plm::lag(Region_libdem, 1)` = "Regional democracy(t-1)",
      `plm::lag(muslism_prop_2010, 1)` = "Percent Muslim (t-1)",
      `plm::lag(dependence_pc_di, 1)` = "Resource Dependence(t-1)"
    )
  ) +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 2) +
  theme_minimal() +
  ggtitle("DV: Liberal Democracy (Vdem)") +
  xlab("Coefficient Estimate") +
  theme(
    axis.title.y = element_blank(),
    legend.position = "bottom",
    legend.title = element_blank()
  )

gridExtra::grid.arrange(plot_pooled,plot_pooled2, ncol = 2)
```

However, when accounting for the uncertainty of the latent variable measurement of the mood, the significance disappears.
We applied the DCPO and added one-third more data, resulting in a saliently shrink of the range of measurement uncertainty, but the confidence intervals still cut zero---that is, remaining statistically insignificant.^[The point estimates also alters. We attribute it to more information and better measuring method by DCPO.]
A similar phenomenon also happens on the estimates of, for example, the second-time-unit lag of democratization and resource dependency.

We further examined Claassen's regime specific model [@Claassen2020a: Model 2].
The originally significant contribution of democratic mood in democratic regimes disappears, regardless whether more information and better method are applied.

```{r claassenAPSR}
sd.plm <- pdata.frame(x, index = c("Country", "Year")) 

mods <- vector(mode = "list")

mods[[1]] <- plm(
  diff(SupDem_trim, lag = 1) ~ plm::lag(SupDem_trim, 1:2) + diff(Libdem_z, lag = 1)
  + plm::lag(Libdem_z, 1) + diff(lnGDP_imp, lag = 1) + plm::lag(lnGDP_imp, 1),
  sd.plm,
  model = "pooling"
)
mods[[2]] <- plm(
  diff(SupDem_trim, lag = 1) ~ plm::lag(SupDem_trim, 1:2) + diff(Libdem_z, lag = 1)
  + plm::lag(Libdem_z, 1) + diff(lnGDP_imp, lag = 1) + plm::lag(lnGDP_imp, 1)
  + diff(Corrup_TI_z, lag = 1) + plm::lag(Corrup_TI_z, 1),
  sd.plm,
  model = "pooling"
)

df_result_clsAPSR <- map(mods, function(aMod){
  tidy(aMod, conf.int = TRUE) %>%
    mutate(std.error = vcovHC_se(aMod),
           n = nobs(aMod))
})

save(df_result_clsAPSR, file = here::here("output", "estimates_clsMeanAPSR.RDS"))
```

```{r claassenAPSRUncertainty}
ls_country <- unique(claassen_replication_input$data$country)
first_year <- min(claassen_replication_input$data$year)

sd_control <- sd.plm %>%
  mutate(
    country = as.character(Country),
    year = as.numeric(as.character(Year))
  )

df_clsAPSR <- purrr::map(1:1000, function(anEntry) {
  claassen_m5_theta$theta[anEntry,,] %>% 
    reformat_dcpo_output("theta") %>% 
    # left_join(reformat_dcpo_output(dcpo_sigma$sigma[anEntry,,], "sigma"),
    #           by = c("year", "country")) %>%
    left_join(sd_control, by = c("country", "year")) %>% 
    plm::pdata.frame(index = c("country", "year"))
})


estimate_cls <- vector(mode = "list")

estimate_cls[[1]] <- function(aDataset) {
  plm(
      diff(theta, lag = 1) ~ plm::lag(theta, 1:2) + diff(Libdem_z, lag = 1)
  + plm::lag(Libdem_z, 1) + diff(lnGDP_imp, lag = 1) + plm::lag(lnGDP_imp, 1),
      model = "pooling",
      data = aDataset
    )
}

estimate_cls[[2]] <- function(aDataset) {
  plm(
      diff(theta, lag = 1) ~ plm::lag(SupDem_trim, 1:2) + diff(Libdem_z, lag = 1)
  + plm::lag(Libdem_z, 1) + diff(lnGDP_imp, lag = 1) + plm::lag(lnGDP_imp, 1)
  + diff(Corrup_TI_z, lag = 1) + plm::lag(Corrup_TI_z, 1),
      model = "pooling",
      data = aDataset
    )
}


df_result_clsUncertainAPSR <- map(estimate_cls, function(aModel){
  aFit <- map(df_clsAPSR, aModel)
  
  result_vars_cls_1k <- mitools::MIextract(aFit, fun = vcovHC_se)
  result_betas_cls_1k <- mitools::MIextract(aFit, fun = coef)
  
  summary(
      mitools::MIcombine(results = result_betas_cls_1k, 
                         variance = result_vars_cls_1k)
    ) %>% rownames_to_column(var = "term") %>%
    rename(conf.low = `(lower`,
           conf.high = `upper)`,
           estimate = results) %>%
    filter(!str_detect(term, "(Intercept)"))

})

save(df_result_clsUncertainAPSR, file = here::here("output", "estimates_clsAPSR.RDS"))
```

```{r dcpoPointAPSR}
df_controls <- read_csv(here::here("data", "control_variables_apsr.csv"),
                        col_types = cols(.default = col_double(),
                                         country = col_character(),
                                         country_name = col_character(),
                                         ISO = col_character(),
                                         Region_UN = col_character())) %>% 
  mutate(country0 = iconv(country, "latin1", "UTF-8", sub=''),
         country = countrycode::countrycode(country0, "country.name", "country.name")) %>% 
  filter(year >= firstyear)

load(here::here("output", "estimates_dcpoMean.RDS"))

df_dcpoMeanAPSR <- df_dcpoMean %>% 
  left_join(df_controls, by = c("country", "year")) %>% 
  plm::pdata.frame(index = c("country", "year"))

mods <- vector(mode = "list")
mods[[1]] <-
  plm(
    diff(theta, lag = 1) ~ plm::lag(theta, 1:2) + diff(Vdem_libdem_z, lag = 1)
    + plm::lag(Vdem_libdem_z, 1) + diff(lg_imp_mdpgdp, lag = 1) + plm::lag(lg_imp_mdpgdp, 1),
    data = df_dcpoMeanAPSR,
    model = "pooling"
  )

mods[[2]] <-
  plm(
    diff(theta, lag = 1) ~ plm::lag(theta, 1:2) + diff(Vdem_libdem_z, lag = 1) + plm::lag(Vdem_libdem_z, 1) + diff(lg_imp_mdpgdp, lag = 1) + plm::lag(lg_imp_mdpgdp, 1) + diff(corruption_z, lag = 1) + plm::lag(corruption_z, 1),
    data = df_dcpoMeanAPSR,
    model = "pooling"
  )

df_result_dcpoMeanAPSR <- map(mods, function(aMod) {
  aMod %>% 
    tidy %>%
    mutate(std.error = vcovHC_se(aMod),
           n = nobs(aMod`))
})

save(df_result_dcpoMeanAPSR, file = here::here("output", "estimates_dcpoMeanAPSR.RDS"))
```

```{r dcpoUncertaintyAPSR}
df_dcpo <- purrr::map(1:1000, function(anEntry) {
  dcpo_theta$theta[anEntry,,] %>% 
    reformat_dcpo_output("theta") %>% 
    left_join(reformat_dcpo_output(dcpo_sigma$sigma[anEntry,,], "sigma"),
              by = c("year", "country")) %>%
    left_join(df_controls, by = c("country", "year")) %>% 
    plm::pdata.frame(index = c("country", "year"))
})

estimate_dcpo <- vector(mode = "list")

estimate_dcpo[[1]] <- function(aDataset) {
  plm(
      diff(theta, lag = 1) ~ plm::lag(theta, 1:2) + diff(Vdem_libdem_z, lag = 1)
      + plm::lag(Vdem_libdem_z, 1) + diff(lg_imp_mdpgdp, lag = 1) + plm::lag(lg_imp_mdpgdp, 1),
      model = "pooling",
      data = aDataset
    )
}

estimate_dcpo[[2]] <- function(aDataset) {
  plm(
      diff(theta, lag = 1) ~ plm::lag(theta, 1:2) + diff(Vdem_libdem_z, lag = 1) + plm::lag(Vdem_libdem_z, 1) + diff(lg_imp_mdpgdp, lag = 1) + plm::lag(lg_imp_mdpgdp, 1) + diff(corruption_z, lag = 1) + plm::lag(corruption_z, 1),
      model = "pooling",
      data = aDataset
    )
}


df_result_dcpoAPSR <- map(estimate_dcpo, function(aModel){
  aFit <- map(df_dcpo, aModel)
  
  result_vars_dcpo_1k <- mitools::MIextract(aFit, fun = vcovHC_se)
  result_betas_dcpo_1k <- mitools::MIextract(aFit, fun = coef)
  
  summary(
      mitools::MIcombine(results = result_betas_dcpo_1k, 
                         variance = result_vars_dcpo_1k)
    ) %>% rownames_to_column(var = "term") %>%
    rename(conf.low = `(lower`,
           conf.high = `upper)`,
           estimate = results) %>%
    filter(!str_detect(term, "(Intercept)"))

})

save(df_result_dcpoAPSR, file = here::here("output", "estimates_dcpoAPSR.RDS"))
```

```{r visualizedAPSR, fig.cap= "\\label{fig:visualizedAPSR} Effects of Democracy on Change in Mood", eval = TRUE, fig.width=7, fig.height=5}

load(here::here("output", "estimates_clsMeanAPSR.RDS"))
load(here::here("output", "estimates_clsAPSR.RDS"))
load(here::here("output", "estimates_dcpoAPSR.RDS"))

df_plot <- df_result_clsAPSR[[1]] %>% 
  mutate(model = "Claassen 2020b") 

df_plot <- df_result_clsUncertainAPSR[[1]] %>% 
  mutate(model = "Claassen w/ Uncertainty") %>%  
  bind_rows(df_plot)

df_plot <- df_result_dcpoAPSR[[1]] %>% 
  mutate(model = "DCPO") %>%  
  bind_rows(df_plot)

df_plotS <- df_plot %>%
  filter(term != "(Intercept)") %>%
  mutate(
    term = rep(
      c("Democratic Mood\n (t-1)",
        "Democratic Mood\n (t-2)",
      "Liberal Democracy\n (Difference)",
      "Liberal Democracy\n (t-1)",
      "Log GDP\n per capita\n (Difference)",
      "Log GDP\n (t-1)"),
    time = 3)
  )

terms <- factor(rev(c("Support[t-1]",
                      "Support[t-2]",
                      "Delta~Liberal~democracy",
                      "Liberal~democracy[t-1]",
                      "Delta~Log~GDP~per~capita",
                      "Log~GDP[t-1]")),
                levels = rev(c("Support[t-1]",
                               "Support[t-2]",
                               "Delta~Liberal~democracy",
                               "Liberal~democracy[t-1]",
                               "Delta~Log~GDP~per~capita",
                               "Log~GDP[t-1]")))

df_tableAPSR <- df_plotS %>% mutate(
  conf = paste0("[", round(conf.low, digits = 2), ", ", round(conf.high, digits = 2), "]"),
  group = "Basic"
) %>% 
  select(term, estimate, conf, n, model, group) %>% 
  fill(n, .direction = "up")

plot_APSR1 <- dwplot(df_plotS, dodge_size = 0.8, by_2sd = FALSE) +
  scale_y_discrete(labels = parse(text = levels(terms))) +
  scale_color_grey(start = 0.4, end = 0.8, guide = guide_legend(reverse = TRUE)) +
  # scale_color_uiowa(name = "", palette = "digitMixed") +
  labs(
    title = "DV: Democratic Mood",
    subtitle = "Basic"
  ) +
  theme(legend.position = "none")

 
df_plot <- df_result_clsAPSR[[2]] %>% 
  mutate(model = "Claassen 2020b") 

df_plot <- df_result_clsUncertainAPSR[[2]] %>% 
  mutate(model = "Claassen w/ Uncertainty") %>%  
  bind_rows(df_plot)

df_plot <- df_result_dcpoAPSR[[2]] %>% 
  mutate(model = "DCPO") %>%  
  bind_rows(df_plot)

df_plotS <- df_plot %>%
  filter(term != "(Intercept)") %>%
  mutate(
    term = rep(
      c("Democratic\n Mood\n (t-1)",
        "Democratic\n Mood\n (t-2)",
      "Liberal\n Democracy\n (Difference)",
      "Liberal\n Democracy\n (t-1)",
      "Log GDP\n per capita\n (Difference)",
      "Log GDP\n (t-1)",
      "Corruption\n (Difference)",
      "Corruption\n (t-1)"
      ),time = 3)
  )

terms2 <- factor(rev(c("Support[t-1]",
                      "Support[t-2]",
                      "Delta~Liberal~democracy",
                      "Liberal~democracy[t-1]",
                      "Delta~Log~GDP~per~capita",
                      "Log~GDP[t-1]",
                      "Delta~Corruption",
                      "Corruption[t-1]")),
                levels = rev(c("Support[t-1]",
                               "Support[t-2]",
                               "Delta~Liberal~democracy",
                               "Liberal~democracy[t-1]",
                               "Delta~Log~GDP~per~capita",
                               "Log~GDP[t-1]",
                               "Delta~Corruption",
                               "Corruption[t-1]")))

df_tableAPSR <- df_plotS %>% mutate(
  conf = paste0("[", round(conf.low, digits = 2), ", ", round(conf.high, digits = 2), "]"),
  group = "W. Corruption"
) %>% 
  select(term, estimate, conf, n, model, group) %>% 
  fill(n, .direction = "up") %>% 
  bind_rows(df_tableAPSR) %>% 
  mutate(estimate = round(estimate, digits = 3))

plot_APSR2 <- dwplot(df_plotS, dodge_size = 0.8, by_2sd = FALSE) +
  scale_y_discrete(labels = parse(text = levels(terms2))) +
  scale_color_grey(start = 0.4, end = 0.8, guide = guide_legend(reverse = TRUE)) +
  # scale_color_uiowa(name = "", palette = "digitMixed") +
  labs(
    title = "",
    subtitle = "w/ Corruption"
  ) +
  theme(legend.position = "bottom", legend.title = element_blank())

legend <- get_legend(plot_APSR2)

plot_APSR2 <- plot_APSR2 +
  theme(legend.position = "none")

gridExtra::grid.arrange(plot_APSR1, plot_APSR2, legend, ncol=2, nrow = 2, 
             layout_matrix = rbind(c(1,2), c(3,3)),
             widths = c(2.7, 2.7), heights = c(2.5, 0.2))
```

```{r visualizedUncertaintyAPSR, fig.cap= "The Effect of Democratic Mood on Institutional Democratization based on DCPO"}

load(here::here("output", "estimates_dcpoAPSR.RDS"))

df_plot <- df_result_dcpoMeanAPSR[[1]] %>% 
  mutate(model = "DCPO\n (Point Estimates)") 
 
df_plot <- df_result_dcpoAPSR[[1]] %>%
  mutate(model = "DCPO\n (w. Uncertainty)") %>%
  rename(std.error = se) %>%
  bind_rows(df_plot)
 
plot_pooled <- filter(df_plot, model != "Claassen 2019") %>% 
  dwplot(by_2sd = FALSE) %>%
  relabel_predictors(
    c(
      `plm::lag(theta, 1:2)1` = "Democracy Mood(t-1)",
      `plm::lag(theta, 1:2)2` = "Democracy Mood(t-2)",
      `diff(Vdem_libdem_z, lag = 1)` = "Liberal Democracy (Diff)",
      `plm::lag(Vdem_libdem_z, 1)` = "Liberal Democracy (t-1)",
      `diff(lg_imp_mdpgdp, lag = 1)` = "Log GDP per capita(Diff)", 
      `plm::lag(lg_imp_mdpgdp, 1)` = "Log GDP per capita(t-1)",
      `plm::lag(mdprgdp_grwth, 1)` = "Corruption (Difference)"
    )
  ) +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 2) +
  theme_minimal() +
  ggtitle("DV: Liberal Democracy (Vdem)") +
  xlab("Coefficient Estimate") +
  theme(
    axis.title.y = element_blank(),
    legend.position = "bottom",
    legend.title = element_blank()
  )

df_plot <- df_result_dcpoMeanAPSR[[2]] %>% 
  mutate(model = "DCPO\n (Point Estimates)")

df_plot <- df_result_dcpoAPSR[[2]] %>%
  mutate(model = "DCPO\n (w. Uncertainty)") %>%
  rename(std.error = se) %>%
  bind_rows(df_plot)
 
plot_pooled2 <- filter(df_plot, model != "Claassen 2019") %>% 
  dwplot(by_2sd = FALSE) %>%
  relabel_predictors(
    c(
      `plm::lag(theta, 1:2)1` = "Democracy Mood(t-1)",
      `plm::lag(theta, 1:2)2` = "Democracy Mood(t-2)",
      `diff(Vdem_libdem_z, lag = 1)` = "Liberal Democracy (Diff)",
      `plm::lag(Vdem_libdem_z, 1)` = "Liberal Democracy (t-1)",
      `diff(lg_imp_mdpgdp, lag = 1)` = "Log GDP per capita(Diff)", 
      `plm::lag(lg_imp_mdpgdp, 1)` = "Log GDP per capita(t-1)",
      `diff(cpi_sd, lag = 1)` = "Corruption (Difference)",
      `plm::lag(cpi_sd, 1)` = "Corruption (t-1)"
    )
  ) +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 2) +
  theme_minimal() +
  ggtitle("DV: Liberal Democracy (Vdem)") +
  xlab("Coefficient Estimate") +
  theme(
    axis.title.y = element_blank(),
    legend.position = "bottom",
    legend.title = element_blank()
  )

gridExtra::grid.arrange(plot_pooled,plot_pooled2, ncol = 2)
```

```{r save_tables, eval=TRUE}
save(df_tableAJPS, df_tableAPSR, file = here::here("output", "df_tables.rda"))

```

The importance of accounting for the measurement uncertainty appear more evident when the relevant variable plays as the dependent variable. 
In Figure&nbsp;\ref{fig:visualizedAPSR}, we examined the thermostatic model of democratic mood [@Claassen2020b]. 
The estimates without taking uncertainty into account imply that democratic mood decreases along with the progress of democratization. 
Nevertheless, this effect no longer holds when the measurement uncertainty is involved. 

As previous operations, we tested if this alteration is caused by the data scarcity or estimating inefficiency. 
When more data and better method are applied, the confidence intervals do shrink yet remain statistically insignificant. 
We observed similar changes after adjusting the effect of domestic corruption [@Claassen2020b, 41]. 

# Discussion
In short, the main empirical findings about the estimated effect of public democratic support on democracy or vice versa are not replicable when measurement uncertainty is accounted for, even using better measurement and more data.

There are several potential causes for the null results.
First, the survey items we used might not capture real public democratic attitudes since the number of indicators of democratic support is limited compared to indicators of other concepts like gender-egalitarianism (Solt, 2021??).
Second, even if survey questions capture the support for the generic concept of democracy, they might still not be sufficient to capture the multi-faceted feature of democratic support due to the variation in understanding the concept across countries or over time or within country [@wuttke2020have;@van2017myth]. 
As @van2017myth pointed out, without considering the varying understanding of democracy due to political and social development, the unchanged survey questions decrease the comparability of time series data. 
Third, these survey items might capture public democratic support, but we do not have enough data to compensate for the fragmentation and sparseness of available comparative public opinion data, which is doomed to high uncertainty.
Given the nature trail of latent variables and specific characters of comparative public opinion data, performing analyses based on the strong assumption that comparative public attitudes are perfectly measured might exaggerate scholars' certainty methodologically and obscure a proper substantive evaluation of theoretical claims.


In addition, there are alternative explanations about the relationship between public attitude and democratic changes.
First, democratic changes might be more associated with elites than with the public.
Elites are thought to play a critical role in preserving democratic stability by respecting the limits on their behaviors [@weingast_political_1997].
However, after the Cold War, many democracies backslid and were imperiled worldwide because elected leaders lacked commitment to democratic norms and the public even did not notice that [@bermeo_democratic_2016; @levitsky_how_2018; @waldner_unwelcome_2018].

Second, given that the measures for democratic development are from experts, the gulf between public perception and elites' perception on important democratic principles [@mcclosky_consensus_1964] might result in the disconnection between public perception of democracy and experts' measures of the levels of democracy.
A recent study also lent support to that claim by demonstrating the polarized public cannot reach a consensus with experts on democratic erosion [@carey_searching_2019].

Third, the study of democratic support is suffered from "inputism," which focuses on public evaluations of input-side, institutional designs, but ignores the output-side, policy outcome or implementation; however, the output-side better predicts democratic support [@van2017myth]. 

Lastly, verbal support in a pro-democratic stance is usually higher than behavioral commitments [@prothro_fundamental_1960]. 
Since there is a difference in public support for democracy between "in the abstract" and "under specific propositions" [@bartels_ethnic_2020], recent studies questioned whether conventional measures of public support for democracy could capture real public commitment to democracy. 
By using survey experiments, @graham_democracy_2020 pointed out a "fundamental blind spot" in traditional measures of public democratic support: general survey questions cannot capture voters' willingness and behavioral commitment to democratic principles in specific context where voters need to choose between democratic norms and their partisan identification or policy preference. 
It turned out that voters subordinated democratic norms to their partisan preference by not electorally penalizing their candidates who endorse measures that violate norms.
Furthermore, voters support/encourage democratic norm-eroding policies when their co-partisans are in power rather than only tolerating anti-democratic policies [@Carey2020]. 


# Conclusion
In this note, we reexamined the findings from Claassens' [-@Claassen2020a; -@Claassen2020b] paper that public support helps the survival of democracy and democratic development has a thermostatic effect on public support for democracy.
We demonstrated the importance of incorporating measurement uncertainty in analyzing the relationship between public support and democratic development.
Even using more data and the sophisticated DCPO model, the measurement uncertainty made the original positive relationships irreplicable regardless whether public support was an independent or dependent variable.

The high uncertainty might come from several sources: the problems of self-report survey data that might not capture the public attitude, the sparse data on the complex concept of democratic support, the relationship between democratic changes and elites, the different public understanding of democracy, and the gap between the public attitude and public commitment. 

Although we could not identify or exclude any one of these possible sources in this paper, a basic lesson from this reexamination is simple: given the inherent uncertainty accompanying latent public opinion and its propagated effects in analyses, incorporating measurement uncertainty is a safer way to infer the relationship between public opinion and other substantive interest especially in comparative politics, in which the measurement uncertainty of public opinion is further exacerbated by the sparse and incomparability of indicators.

\pagebreak

# References

<div id="refs"></div>


